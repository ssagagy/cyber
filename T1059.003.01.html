<!DOCTYPE html>
<html>
<head>
    <title>T1059.003.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1059.003.01 windows command shell</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>systeminfo 프로세스의 실행을 탐지한다.</p>

<h3>Detection(EDR)</h3>

<p><img src="T1059.003.01.png" alt="T1059 003 01" /></p>

<h3>Response</h3>

<p>Windows Command Shell의 특정 명령어와 스크립트 실행을 제한하거나 금지하는 그룹 정책 설정을 적용한다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>CMD 실행 제한 및 권한 관리 (M1038 - Execution Prevention)</strong></p>

<ul>
<li><strong>CMD.exe 실행을 제어</strong>하고, <strong>관리자 권한이 필요한 프로세스에서만 CMD 실행 가능</strong>하도록 제한  </li>
<li><strong>AppLocker</strong> 또는 <strong>WDAC(Windows Defender Application Control)</strong>를 사용하여 <strong>CMD 실행을 화이트리스트</strong> 기반으로 제한  </li>
<li><strong>CMD를 통한 원격 명령 실행</strong>을 비활성화하여 공격자가 원격에서 CMD를 실행할 수 없도록 설정</li>
</ul></li>
<li><p><strong>스크립트 실행 정책 및 제어 (M1038 - Execution Prevention)</strong></p>

<ul>
<li><strong>스크립트 실행 정책을 설정</strong>하여 <strong>스크립트 및 배치 파일(.bat, .cmd 등)의 실행을 제한</strong>  </li>
<li><strong>스크립트 블록 로깅</strong>을 활성화하여 <strong>CMD를 통해 실행된 명령 및 스크립트를 추적</strong>  </li>
<li><strong>스크립트 실행에 대한 사용자 권한을 제한</strong>하고, <strong>서명되지 않은 스크립트의 실행을 차단</strong>  </li>
</ul></li>
<li><p><strong>PowerShell 및 CMD 명령어 실행 모니터링 (M1047 - System Logging &amp; Monitoring)</strong></p>

<ul>
<li><strong>Sysmon(Event ID 1)</strong>을 활용하여 <strong>CMD 명령어 실행</strong>을 모니터링하고, 의심스러운 명령어 실행을 추적  </li>
<li><strong>Windows 이벤트 로그</strong>를 통해 CMD에서 실행된 명령어 및 스크립트를 기록하고, <strong>비정상적인 실행 패턴</strong>을 분석  </li>
<li><strong>EDR/XDR 솔루션</strong>을 사용하여 <strong>CMD 및 배치 파일 실행을 실시간으로 감지</strong>하고 악성 명령어를 탐지</li>
</ul></li>
<li><p><strong>고급 명령어 및 악성 활동 탐지 (M1040 - Behavior-Based Detection)</strong></p>

<ul>
<li><strong>CMD 명령어를 통해 시스템에 비정상적인 명령이 실행</strong>되는 경우 탐지 및 경고 시스템을 활성화  </li>
<li><strong>네트워크 접속, 프로세스 생성, 시스템 설정 변경</strong>과 같은 악성 활동을 탐지하는 규칙 설정  </li>
<li>의심스러운 <strong>배치 파일, 명령어 인젝션, 권한 상승</strong>을 탐지하는 데 중점을 둔 탐지 메커니즘 설정</li>
</ul></li>
<li><p><strong>배치 파일 및 스크립트 서명 및 검증 (M1043 - Code Signing)</strong></p>

<ul>
<li><strong>배치 파일 및 CMD 스크립트의 서명 검증</strong>을 활성화하여 <strong>서명되지 않은 파일의 실행을 차단</strong>  </li>
<li><strong>스크립트 파일</strong>에 대한 디지털 서명을 강제하고, <strong>서명되지 않은 스크립트의 실행을 차단</strong>  </li>
<li><strong>배치 파일 및 스크립트의 무결성 검사</strong>를 통해 악성 코드 삽입을 방지</li>
</ul></li>
<li><p><strong>사용자 계정 및 권한 관리 (M1018 - User Account Management)</strong></p>

<ul>
<li><strong>관리자 권한을 가진 계정의 CMD 사용을 제한</strong>하고, <strong>최소 권한 원칙</strong>을 적용하여 사용자 계정의 권한을 최소화  </li>
<li><strong>관리자 계정에 대한 제어를 강화</strong>하고, <strong>CMD를 통해 시스템 변경을 할 수 없도록 제한</strong>  </li>
<li><strong>사용자 계정 관리</strong>를 통해 <strong>비관리자 계정이 CMD 명령어를 실행할 수 없도록 설정</strong></li>
</ul></li>
<li><p><strong>네트워크 및 파일 시스템 접근 제어 (M1047 - System Logging &amp; Monitoring)</strong></p>

<ul>
<li><strong>CMD를 통한 네트워크 요청</strong>이나 <strong>파일 시스템 수정</strong>을 추적하여 <strong>비정상적인 접근</strong>을 감지  </li>
<li><strong>파일 시스템 및 네트워크 로그</strong>를 활용하여 CMD를 통해 실행된 파일 및 네트워크 연결을 분석하고 탐지  </li>
<li><strong>네트워크 요청 및 시스템 설정 변경</strong>이 의도된 활동인지 여부를 모니터링
<h2>Affected Techniques</h2></li>
</ul></li>
</ol>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1059.003</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-PM Platform Monitoring</td>
</tr>
<tr>
  <td style="text-align:center;">D3-PLA Process Lineage Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-PCA Process Code Segment Verification</td>
</tr>
</tbody>
</table>

</body>
</html>
