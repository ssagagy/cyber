<!DOCTYPE html>
<html>
<head>
    <title>T1218.005.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1218.005.01 mshta이용 proxy 서버에서 파일 다운로드/실행</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>모니터링을 통해 mshta가 다운로드 기능의 스크립트 실행이 있는지 확인합니다.</p>

<h3>Detection(EDR)</h3>

<p><img src="T1218.005.01.png" alt="" />
https://asd.ahnlab.com/rule/asde3/view?ruleSeq=12342</p>

<h3>Response</h3>

<p>공격자가 생성한 파일을 삭제합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>mshta.exe 실행 제한 (M1042 - Disable or Remove Feature or Program)</strong>  </p>

<ul>
<li><strong>AppLocker 또는 WDAC(Windows Defender Application Control) 정책을 활용하여 mshta.exe 실행 차단</strong>  </li>
<li><strong>HTA 파일(.hta) 실행 차단</strong>  </li>
</ul></li>
<li><p><strong>mshta.exe 실행 모니터링 및 탐지 (M1047 - System Logging &amp; Monitoring &amp; M1038 - Execution Prevention)</strong>  </p>

<ul>
<li><strong>Windows 이벤트 로그(Event ID 4688)에서 mshta.exe 실행 감시</strong>  </li>
<li><strong>EDR/XDR 솔루션을 활용하여 mshta.exe 실행 패턴 분석 및 이상 행동 탐지</strong>  </li>
</ul></li>
<li><p><strong>원격 HTA 파일 실행 차단 (M1031 - Network Segmentation &amp; M1037 - Network Intrusion Prevention)</strong>  </p>

<ul>
<li><strong>프록시 및 방화벽을 설정하여 외부 네트워크에서 HTA 파일 다운로드 차단</strong>  </li>
<li><strong>HTTP/HTTPS를 통해 mshta.exe가 직접 실행되지 않도록 네트워크 정책 구성</strong>  </li>
</ul></li>
<li><p><strong>최소 권한 원칙 적용 (M1026 - Privileged Account Management)</strong>  </p>

<ul>
<li><strong>일반 사용자 계정에서 mshta.exe 실행 제한</strong>  </li>
<li><strong>HTA 파일이 관리자 권한 없이 실행되지 않도록 UAC(User Account Control) 정책 적용</strong>  </li>
</ul></li>
<li><p><strong>사용자 교육 및 보안 인식 강화 (M1019 - Awareness and Training)</strong>  </p>

<ul>
<li><strong>HTA 파일을 통한 피싱 공격 및 악성 코드 실행 위험에 대한 교육 실시</strong>  </li>
<li><strong>의심스러운 이메일 첨부파일(HTA, JS, VBS 등) 실행 금지 안내</strong>  </li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1218.005</td>
</tr>
<tr>
  <td style="text-align:center;">T1047</td>
</tr>
<tr>
  <td style="text-align:center;">T1059.001</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-PWSAM Proxy-based Web Server Access Mediation</td>
</tr>
</tbody>
</table>

</body>
</html>
