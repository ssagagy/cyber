<!DOCTYPE html>
<html>
<head>
    <title>T1547.005.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1547.005.01 보안 공급자(SSP)에 악성코드 등록</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>파워쉘 인자에서 Set-ItemProperty, \currentcontrolset\control\lsa, security packages 명령어를 탐지한다.</p>

<h3>Detection(EDR)</h3>

<p><img src="T1547.005.01.png" alt="T1547 005 01" /></p>

<h3>Response</h3>

<p>공격자가 수정한 레지스트리 키를 원복합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>SSP 등록 모니터링 및 제한</strong>  </p>

<ul>
<li>Windows 레지스트리에서 <strong>SSP 등록 키 (<code data-language="powershell">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code>)</strong> 를 정기적으로 검사하여 비정상적인 추가 여부를 확인합니다.  </li>
<li>그룹 정책(GPO)을 사용하여 SSP 등록을 제한하고, 승인된 패키지만 허용합니다.  </li>
</ul></li>
<li><p><strong>Windows 보안 설정 강화</strong>  </p>

<ul>
<li><strong>LSASS 보호 활성화</strong>: Windows 10 이상에서는 <code data-language="powershell">RunAsPPL</code>(Protected Process Light) 기능을 활성화하여 LSASS 프로세스를 보호합니다.  </li>
<li>Credential Guard를 사용하여 인증서 탈취를 방지합니다.  </li>
</ul></li>
<li><p><strong>파일 및 프로세스 무결성 검사</strong>  </p>

<ul>
<li><code data-language="powershell">C:\Windows\System32</code> 디렉터리 내 SSP 관련 파일을 정기적으로 검사하여 변조 여부를 확인합니다.  </li>
<li>SIEM(Security Information and Event Management) 솔루션을 활용하여 SSP 로드 이벤트를 모니터링합니다.  </li>
</ul></li>
<li><p><strong>레지스트리 변경 감지 및 경고</strong>  </p>

<ul>
<li>Sysmon(Event ID 13 - 레지스트리 변경) 및 Windows Event Logs를 활용하여 <code data-language="powershell">Security Packages</code> 키 변경을 실시간으로 감지합니다.  </li>
<li>레지스트리 모니터링 도구(예: Autoruns, OSSEC) 사용하여 비정상적인 변경 사항을 탐지합니다.  </li>
</ul></li>
<li><p><strong>엔드포인트 보호 솔루션 적용</strong>  </p>

<ul>
<li>EDR(Endpoint Detection and Response) 솔루션을 사용하여 <strong>악성 SSP 로드 시도를 탐지 및 차단</strong>합니다.  </li>
<li>Windows Defender ATP(또는 기타 보안 솔루션)에서 LSASS 관련 의심스러운 동작을 감시합니다.  </li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">Techniques</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1547.005</td>
</tr>
</tbody>
</table>

</body>
</html>
