<!DOCTYPE html>
<html>
<head>
    <title>T1036.002.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1036.002.01 Masquerading Right-to-Left Override</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>RLO(Right to Left Override) 문자가 포함된 파일을 실행하는 명령어 혹은 파일 확장자를 탐지합니다.</p>

<h3>Detection(EDR)</h3>

<p>행동 유형 : 프로세스 생성</p>

<p>오퍼레이션 : contains</p>

<p>값 : U+202E와 같은 RTL 문자를 탐지</p>

<h3>Response</h3>

<ol>
<li>프로세스 및 파일 실행 로그 분석:</li>
</ol>

<p>의심스러운 파일 이름이나 실행 경로를 모니터링하여 악성 코드가 실행되는지 확인합니다. 예를 들어, C:\Windows\System32 디렉터리에서 실행되는 비정상적인 파일을 모니터링합니다.</p>

<ol start="2">
<li>Windows 이벤트 로그 분석:</li>
</ol>

<p>Windows 이벤트 로그에서 파일 실행 및 변경 이벤트를 분석하여 정상적인 파일 이름이 아닌 파일이 실행되었는지 확인합니다, 예시: Event ID 4688 (새로운 프로세스 생성) 이벤트 로그를 통해 실행된 프로세스를 추적하고, 의심스러운 파일이 실행되었는지 분석합니다.</p>

<ol start="3">
<li>디지털 서명 확인:</li>
</ol>

<p>실행 파일의 디지털 서명이 유효한지 확인하여, 서명이 없는 파일이나 서명이 변조된 파일을 탐지합니다. 파일의 디지털 서명이 의심스러울 경우 추가 분석을 실시합니다.</p>

<ol start="4">
<li>파일 해시 값 비교:</li>
</ol>

<p>주기적으로 시스템에서 중요한 파일들의 해시 값을 확인하고, 정상적인 파일과 비교하여 해시 값이 변경된 경우 경고를 발생시킵니다.</p>

<ol start="5">
<li>EDR(Endpoint Detection and Response) 활용:</li>
</ol>

<p>EDR 솔루션을 활용하여 의심스러운 프로세스를 실시간으로 탐지하고, 정상적인 파일 위치나 이름을 가장하는 프로그램을 식별합니다. EDR은 비정상적인 실행 파일 및 네트워크 활동을 감지하고 경고를 보냅니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>디지털 서명 확인</strong></p>

<ul>
<li>실행 파일에 디지털 서명이 적용되었는지 확인하고, 서명이 없는 파일은 실행을 제한합니다, Windows에서 파일의 디지털 서명 유효성을 검사하여 서명이 유효하지 않은 경우 실행을 차단하거나 경고를 표시합니다.</li>
</ul></li>
<li><p><strong>애플리케이션 화이트리스트 적용</strong></p>

<ul>
<li>AppLocker나 Windows Defender Application Control을 사용하여 특정 응용 프로그램만 실행할 수 있도록 제한합니다. 합법적인 애플리케이션만 허용하고, 의심스러운 파일 이름이나 위치에서 실행되는 프로그램을 차단합니다.</li>
</ul></li>
<li><p><strong>운영 체제 및 보안 소프트웨어 최신화</strong></p>

<ul>
<li>운영 체제 및 보안 소프트웨어(예: 안티바이러스, EDR 솔루션)를 최신 버전으로 유지하여 최신 보안 기능과 패치를 적용합니다. 이는 악성 코드나 의심스러운 파일을 탐지하고 차단하는 데 도움이 됩니다.</li>
</ul></li>
<li><p><strong>최소 권한 원칙 적용</strong></p>

<ul>
<li>사용자가 시스템 파일에 접근하거나 프로그램을 실행할 수 있는 권한을 제한합니다. 악성 프로그램이 시스템 파일을 가장해 실행되지 않도록 합니다, 관리자가 아닌 사용자는 시스템 중요한 디렉터리(예: C:\Windows\System32)나 실행 파일이 저장된 디렉터리에 접근할 수 없도록 제한합니다.</li>
</ul></li>
<li><p><strong>폴더 권한 및 파일 접근 제어</strong></p>

<ul>
<li>중요한 시스템 폴더(예: C:\Windows, C:\Program Files)에 대한 읽기/쓰기 권한을 제한합니다. 악성 파일이 정상적인 위치에 저장되지 않도록 하여, 불법적으로 디렉터리 위치를 가장하는 것을 방지합니다.</li>
</ul></li>
<li><p><strong>파일 무결성 검사</strong></p>

<ul>
<li>시스템 파일의 무결성을 주기적으로 검사하고, 예상하지 못한 변경 사항을 모니터링합니다. Windows File Protection(WFP) 또는 SFC (System File Checker) 명령을 사용하여 시스템 파일을 검사하고 복구할 수 있습니다.</li>
</ul></li>
<li><p><strong>MD5/SHA 해시 값 비교</strong></p>

<ul>
<li>의심스러운 파일이나 프로그램의 해시 값을 체크하고, 정상적인 파일과 비교하여 변경된 파일을 탐지할 수 있습니다. 특정 디렉터리에 존재하는 파일들의 해시 값을 정기적으로 확인하여 파일이 변조되었는지 검토합니다.</li>
</ul></li>
<li><p><strong>다단계 인증 (MFA) 적용</strong></p>

<ul>
<li>시스템 및 애플리케이션에서 다단계 인증(MFA)을 사용하여 사용자가 로그인할 때 강력한 인증을 요구합니다. 이 방법은 공격자가 사용자 계정을 훔쳐 악성 프로그램을 실행하는 것을 방지합니다.</li>
</ul></li>
<li><p><strong>침입 탐지 및 방지 시스템 (IDS/IPS) 활용</strong></p>

<ul>
<li>IDS/IPS 시스템을 사용하여 비정상적인 파일 실행이나 의심스러운 네트워크 트래픽을 탐지하고 차단할 수 있습니다. 공격자가 정상적인 경로로 파일을 실행하려는 시도를 감지할 수 있습니다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1036.002</td>
</tr>
</tbody>
</table>

<p>|D3FEND|
|:-----------:|</p>

</body>
</html>
