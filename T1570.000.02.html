<!DOCTYPE html>
<html>
<head>
    <title>T1570.000.02</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1570.000.02 FTP를 이용한 공격 도구 다운로드</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>AMSI Data: New-Object System.Net.NetworkCredential AND ftp://</p>

<h3>Detection(EDR)</h3>

<h3>Response</h3>

<p>자격 증명 덤핑을 막기 위해 자격 증명 보호 및 관리 강화, 강력한 인증 도입, 보안 패치 적용, 자격 증명 덤핑 탐지 및 모니터링 시스템을 설정하는 것입니다. 자격 증명이 유출되면 공격자는 내부 시스템에 접근하여 공격을 확장할 수 있기 때문에, 이러한 방어 조치들을 통해 공격이 발생하지 않도록 예방하는 것이 중요합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>자격 증명 저장 방식 개선</strong></p>

<ul>
<li>자격 증명 암호화
<ul>
<li>자격 증명을 평문이나 약한 해시로 저장하는 것을 피하고, 고급 암호화 알고리즘(예: bcrypt, PBKDF2, Argon2)을 사용하여 자격 증명을 안전하게 암호화합니다.</li>
<li>또한 <strong>하드웨어 보안 모듈(HSM)</strong>을 활용하여 자격 증명을 저장하고 관리할 수 있습니다.</li>
</ul></li>
<li>자격 증명 보호
<ul>
<li>Windows Credential Guard와 같은 기능을 사용하여, 자격 증명이 시스템의 메모리 내에서 노출되지 않도록 보호합니다.</li>
<li>이를 통해 공격자가 시스템의 메모리 덤프를 통해 자격 증명을 탈취할 수 없게 합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>다단계 인증(MFA) 적용</strong></p>

<ul>
<li>MFA 적용
<ul>
<li><strong>다단계 인증(MFA)</strong>을 모든 사용자에게 적용하여, 자격 증명만으로는 시스템에 접근할 수 없도록 만듭니다.</li>
<li>특히, 중요한 시스템과 리소스에 접근할 때 OTP, 생체 인식 등 추가 인증 방법을 요구하여 자격 증명 탈취로 인한 피해를 줄입니다.</li>
</ul></li>
</ul></li>
<li><p><strong>네트워크 세분화 및 액세스 제한</strong></p>

<ul>
<li>네트워크 세분화
<ul>
<li>중요한 시스템과 자격 증명이 저장된 시스템은 네트워크 내에서 분리하여, 공격자가 하나의 시스템에서 자격 증명을 탈취한 후 다른 시스템으로 확장하는 것을 어렵게 만듭니다.</li>
<li>이를 위해 VLAN, 서브넷 등을 사용하여 네트워크를 격리합니다.</li>
</ul></li>
<li>접근 제어
<ul>
<li>제로 트러스트 보안 모델을 적용하여, 모든 네트워크 연결 및 사용자의 인증과 권한을 실시간으로 검증합니다.</li>
<li>네트워크의 각 부분에 대해 최소 권한 원칙을 적용하여, 자격 증명 탈취로 인한 권한 상승을 차단합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>시스템 모니터링 및 침입 탐지</strong></p>

<ul>
<li>로그 분석
<ul>
<li>시스템 로그와 보안 로그를 정기적으로 모니터링하여 자격 증명 덤핑 활동을 탐지할 수 있습니다.</li>
<li>예를 들어, lsass.exe와 같은 중요한 프로세스에 대한 비정상적인 액세스 시도나 메모리 덤프 시도를 추적합니다.</li>
</ul></li>
<li>침입 탐지 시스템(IDS)
<ul>
<li>침입 탐지 시스템을 사용하여 비정상적인 패턴이나 자격 증명 덤핑 시도와 관련된 활동을 실시간으로 탐지합니다.</li>
<li>자동화된 대응 시스템을 구축하여 의심스러운 행동이 발견되면 즉시 알림을 받고 차단할 수 있도록 합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>불필요한 원격 관리 서비스 비활성화</strong></p>

<ul>
<li>불필요한 원격 관리 서비스 비활성화
<ul>
<li>시스템에서 불필요한 원격 관리 서비스(예: RDP, Telnet 등)를 비활성화하여 공격자가 원격으로 시스템에 접속하여 자격 증명을 덤프할 수 있는 기회를 줄입니다.</li>
<li>필요한 서비스에 대해서는 강력한 보안을 적용합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>시스템 및 소프트웨어 패치 관리</strong></p>

<ul>
<li>정기적인 보안 패치 적용
<ul>
<li>자격 증명 덤핑 공격은 취약점을 악용하여 자격 증명을 탈취하는 경우가 많습니다.</li>
<li>운영 체제, 애플리케이션, 보안 소프트웨어의 정기적인 보안 패치를 통해 알려진 취약점을 수정하고 자격 증명 덤핑 공격이 성공하지 않도록 합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>로컬 계정과 권한 관리</strong></p>

<ul>
<li>로컬 관리자 계정 관리
<ul>
<li>불필요한 로컬 관리자 계정을 비활성화하고, 강력한 비밀번호 정책을 적용합니다.</li>
<li>중요한 시스템에서는 로컬 관리자 계정 대신 중앙 관리되는 도메인 계정을 사용하여 보안을 강화합니다.</li>
</ul></li>
<li>권한 관리 및 제한
<ul>
<li>자격 증명을 사용할 수 있는 범위나 시스템 접근 권한을 최소화하여, 공격자가 자격 증명을 탈취하더라도 제한된 액세스 내에서만 사용할 수 있도록 만듭니다.</li>
<li>최소 권한 원칙을 적용하여 시스템과 리소스에 대한 불필요한 접근을 차단합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>정기적인 사용자 교육 및 보안 인식 향상</strong></p>

<ul>
<li>피싱 및 사회 공학 교육
<ul>
<li>사용자에게 피싱 공격 및 사회 공학적 방법에 대한 교육을 제공하여, 자격 증명 탈취를 방지합니다.</li>
<li>이를 통해 사용자가 피싱 이메일이나 웹사이트를 통해 자격 증명 정보를 유출하지 않도록 합니다.</li>
</ul></li>
<li>보안 훈련
<ul>
<li>비밀번호 관리 및 보안에 대한 교육을 통해 직원들이 보안에 대한 책임감을 느끼도록 합니다.</li>
<li>또한, 사용자들이 자격 증명을 안전하게 관리할 수 있도록 유도합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>단일 접속 포인트(SSO) 및 인증 서비스 사용</strong></p>

<ul>
<li>SSO(Single Sign-On) 도입
<ul>
<li><strong>단일 로그인 시스템(SSO)</strong>을 도입하여, 여러 시스템에 대한 자격 증명 관리를 간소화하고 보안성이 향상되도록 합니다.</li>
<li>이를 통해 사용자가 여러 자격 증명을 관리하는 부담을 줄이며, 자격 증명의 분산 관리를 방지합니다.</li>
</ul></li>
<li>중앙 집중식 인증 관리
<ul>
<li>인증 서비스(예: LDAP, Active Directory)를 통해 중앙에서 사용자 계정과 인증을 관리함으로써 자격 증명의 추적 및 보안 관리를 강화합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>자격 증명 덤핑 대응을 위한 보안 툴 사용</strong></p>

<ul>
<li>보안 솔루션
<ul>
<li>자격 증명 덤핑을 방지하는 다양한 보안 솔루션(예: Windows Defender, Symantec Endpoint Protection)을 배포하여 자격 증명이 시스템 메모리에서 안전하게 보호되고, 악성 코드가 자격 증명을 탈취하는 것을 방지합니다.</li>
</ul></li>
<li>행위 기반 탐지
<ul>
<li>행위 기반 탐지(Behavioral Detection) 시스템을 설정하여 정상적이지 않은 사용자 행동(예: 대량의 로그인 실패 시도, 높은 빈도의 계정 정보 접근 등)을 실시간으로 모니터링하고 이상 징후를 탐지합니다.</li>
</ul></li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1553.002</td>
</tr>
<tr>
  <td style="text-align:center;">T1087.003</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-FA File Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-FIM File Integrity Monitoring</td>
</tr>
</tbody>
</table>

</body>
</html>
