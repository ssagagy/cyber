<!DOCTYPE html>
<html>
<head>
    <title>T1033.000.02</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1033.000.02 시스템 소유자/사용자 검색</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<ul>
<li>CurrentProcess : "uesrs" OR "w" OR "w.procps" OR "who"</li>
<li>Action : "CreateProcess" AND</li>
</ul>

<h3>Detection(EDR)</h3>

<p><img src="T1033.000.02.png" alt="T1033 000 02" /></p>

<h3>Response</h3>

<ol>
<li>이벤트 로그 검토: 시스템에서 사용자 계정 정보를 검색한 행위가 있었는지 이벤트 로그를 철저히 분석합니다. Windows의 경우 Security Event Log 또는 PowerShell 로그에서 사용자 조회 명령이 실행된 흔적을 찾을 수 있습니다.</li>
<li>사용자 계정 활동 분석: 조회된 사용자 계정에서 의심스러운 로그인 시도나 권한 상승 시도가 있었는지 모니터링합니다. 시스템 소유자/사용자 정보가 검색된 후 비정상적인 활동이 있다면, 공격자가 해당 정보를 이용해 추가 공격을 시도했을 수 있습니다.</li>
<li>계정 도용 여부 확인: 공격자가 수집한 계정을 사용해 로그인 시도를 하거나, 권한을 탈취해 악성 활동을 벌이는지 여부를 확인합니다. 비정상적인 로그인 시도가 있다면 이를 차단하고, 해당 계정의 암호를 즉시 변경합니다.</li>
<li>의심스러운 계정 조사: 공격자가 의도적으로 생성한 악성 계정이 있을 수 있습니다. 시스템에 존재하는 계정 목록을 점검하고, 관리자 권한을 가진 비정상적인 계정이 있는지 확인한 후 제거합니다.</li>
<li>정보 유출 탐지: 공격자가 수집한 사용자 정보가 외부로 유출되었는지 네트워크 트래픽을 모니터링합니다. 공격자는 시스템 정보를 외부로 전송해 공격을 준비할 수 있으므로, 네트워크 연결 및 비정상적인 트래픽이 있는지 조사합니다.</li>
<li>의심스러운 데이터 전송 차단: 공격자가 수집한 데이터를 외부로 전송하는 것을 차단하기 위해, 방화벽이나 IDS/IPS 시스템을 통해 트래픽을 분석하고, 의심스러운 데이터 전송을 차단합니다.</li>
<li>의심스러운 활동 신고: 사용자에게 의심스러운 계정 검색 활동이나 명령어 실행이 발견되었을 때 즉시 보안 팀에 보고하도록 교육합니다.</li>
<li>암호 재설정: 검색된 사용자 계정의 암호를 변경하여 공격자가 수집한 계정 정보를 통해 시스템에 다시 접근하지 못하도록 합니다. 이때 강력한 암호 정책을 적용합니다.</li>
</ol>

<h3>Mitigations</h3>

<ol>
<li><p><strong>최소 권한 원칙</strong></p>

<ul>
<li>사용자가 불필요하게 높은 권한을 가지지 않도록 최소 권한 원칙(Least privilege)를 적용해야합니다.</li>
</ul></li>
<li><p><strong>관리자 권한 제한</strong></p>

<ul>
<li>시스템에서 관리자 또는 고급 권한을 가진 사용자만 특정 명령을 실행할 수 있도록 권한을 제한합니다.</li>
</ul></li>
<li><p><strong>MFA 적용</strong></p>

<ul>
<li>다단계 인증을 사용하여 사용자 계정이 외부 공격자에 의해 쉽게 탈취되지 않도록 합니다. 공격자가 사용자 정보를 수집하더라도 MFA를 활성화하면 추가적인 인증 절차를 거쳐야 하므로, 계정 도용이 어려워집니다.</li>
</ul></li>
<li><p><strong>사용자 정보 검색 활동 감시</strong></p>

<ul>
<li>시스템 소유자나 사용자 정보를 검색하는 시도가 있을 경우 이를 실시간으로 감지할 수 있는 로그 및 감사 정책을 설정합니다.</li>
</ul></li>
<li><p><strong>IDS/IPS</strong></p>

<ul>
<li>침입 탐지 및 방지 시스템(IDS/IPS)을 사용하여 네트워크를 통해 이루어지는 사용자 정보 검색 활동을 탐지하고 차단합니다. 공격자가 원격으로 시스템에 접속해 사용자 정보를 검색하려는 시도를 감지할 수 있습니다.</li>
</ul></li>
<li><p><strong>보안 인식 교육</strong></p>

<ul>
<li>사용자가 계정 정보 검색과 관련된 명령어나 도구를 실행하는 행위를 이해하고, 이를 통해 공격자가 어떤 정보를 얻을 수 있는지 교육합니다. 이러한 교육을 통해 사용자들이 의심스러운 활동을 인지하고 보안 팀에 보고할 수 있도록 유도합니다.</li>
</ul></li>
<li><strong>관리자 보안 교육</strong>
<ul>
<li>시스템 관리자에게 공격자가 사용자 정보 검색을 통해 얻을 수 있는 정보를 알려주고, 이에 대한 대응 방안을 교육합니다. 관리자는 보안 설정을 강화하여 계정 정보 검색을 방지할 수 있는 방법을 학습해야 합니다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1033.000</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-PLA Process Lineage Analysis</td>
</tr>
</tbody>
</table>

</body>
</html>
