<!DOCTYPE html>
<html>
<head>
    <title>T1543.003.02</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1543.003.02 Windows 서비스 생성/수정</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>프로세스 실행 인자 모니터링을 통해 "sc.exe" 프로세스가 생성되는 행위를 탐지합니다.</p>

<h3>Detection(EDR)</h3>

<p><img src="T1543.003.02.png" alt="" /></p>

<h3>Response</h3>

<ol>
<li>서비스 설치 및 변경 이벤트 확인: </li>
</ol>

<p>서비스가 설치되거나 변경된 시점을 파악하기 위해 Windows 이벤트 로그를 분석합니다.</p>

<ol start="2">
<li>서비스 목록 분석: </li>
</ol>

<p>시스템에 설치된 모든 서비스를 목록화하여 비정상적이거나 의심스러운 서비스를 식별합니다. 특히, 최근에 추가된 서비스나 시스템에 원래 없던 서비스를 중점적으로 조사합니다.</p>

<ol start="3">
<li>실행 파일 분석: </li>
</ol>

<p>서비스와 연관된 실행 파일을 분석하여 악성 여부를 확인합니다. 실행 파일의 경로가 비정상적이거나 불명확한 경우, 바이너리 분석 또는 샌드박스 분석을 통해 해당 파일이 악성인지 확인합니다.</p>

<ol start="4">
<li>서비스 설치 경로 파악: </li>
</ol>

<p>침해 조사(포렌식) 팀은 해당 서비스가 설치된 방법과 경로를 추적해야 합니다. 공격자가 서비스 설치를 위해 사용한 초기 접근 벡터와 권한 상승 방법을 분석합니다.</p>

<ol start="5">
<li>악성 서비스 중지 및 제거: </li>
</ol>

<p>의심스럽거나 악성으로 확인된 서비스는 즉시 중지하고 시스템에서 제거합니다. 이를 위해 sc delete 명령어를 사용하여 서비스를 삭제하거나, Windows 서비스 관리자를 통해 수동으로 제거할 수 있습니다.</p>

<ol start="6">
<li>시스템 복구: </li>
</ol>

<p>서비스 설치로 인해 변경된 시스템 설정을 복구하거나, 감염된 시스템을 포맷하고 클린 이미지를 재설치하는 것이 필요할 수 있습니다.</p>

<ol start="7">
<li>실시간 모니터링: </li>
</ol>

<p>서비스 설치나 변경에 대한 실시간 모니터링을 통해 향후 비정상적인 서비스 설치를 조기에 탐지할 수 있도록 설정합니다.</p>

<ol start="8">
<li>계정 권한 확인: </li>
</ol>

<p>악성 서비스 설치를 수행한 계정의 활동을 추적하고, 비정상적인 권한 상승이 이루어졌는지 확인합니다. 또한, 해당 계정의 비밀번호를 변경하거나 일시적으로 비활성화하여 추가적인 피해를 방지합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>서비스 설치 권한 제한 (M1026 - Privileged Account Management)</strong>  </p>

<ul>
<li><strong>관리자 권한의 최소화</strong>: 일반 사용자에게 시스템 서비스 관련 권한을 부여하지 않도록 설정  </li>
<li><strong>서비스 등록 및 변경 권한 제한</strong>: <strong>서비스 설치 및 변경</strong> 권한을 엄격히 제어하여, <strong>관리자만 서비스 설치 가능</strong>하도록 설정  </li>
<li><strong>관리자 계정에 대한 다단계 인증(MFA)</strong>을 적용하여 권한 상승 후 서비스 등록을 방지  </li>
</ul></li>
<li><p><strong>서비스 모니터링 및 알림 설정 (M1047 - System Logging &amp; Monitoring)</strong>  </p>

<ul>
<li><strong>Windows 서비스 등록 모니터링</strong>: <strong>Event ID 7045</strong>와 같은 <strong>서비스 설치</strong> 이벤트를 모니터링하여 새로운 서비스가 설치될 때 알림을 받도록 설정  </li>
<li><strong>서비스 시작/중지 이벤트</strong>를 실시간으로 기록하고, <strong>EDR/XDR</strong> 솔루션을 사용하여 의심스러운 서비스 관련 활동을 탐지  </li>
<li><strong>서비스 및 프로세스 모니터링</strong>을 통해 새로운 서비스가 자동 실행되는지 확인  </li>
</ul></li>
<li><p><strong>시스템 서비스 및 프로세스 권한 검토 (M1033 - Process Monitoring)</strong>  </p>

<ul>
<li><strong>정기적으로 서비스 목록을 검토</strong>하여 <strong>불필요하거나 의심스러운 서비스</strong>가 없는지 점검  </li>
<li><strong>권한이 부여된 서비스 및 프로세스 목록</strong>을 주기적으로 확인하고, 악성 서비스가 등록되어 있지 않은지 점검  </li>
<li><strong>서비스를 디지털 서명 및 무결성 검증</strong>을 통해 <strong>악성 서비스 설치 방지</strong>  </li>
</ul></li>
<li><p><strong>Windows 보안 설정 강화 (M1040 - Security Configurations)</strong>  </p>

<ul>
<li><strong>Windows 보안 설정</strong>을 강화하여 <strong>악성 서비스 설치</strong>를 방지하고, <strong>서비스 파일에 대한 권한을 제한</strong>  </li>
<li><strong>정기적으로 Windows 업데이트</strong>를 통해 <strong>보안 패치 및 서비스 취약점</strong>을 수정하고, <strong>Windows Defender</strong> 및 <strong>EDR 솔루션</strong>을 활성화  </li>
<li><strong>Windows 서비스 관리자</strong>를 통해 <strong>서비스 등록 시 유효성 검사를 강화</strong>  </li>
</ul></li>
<li><p><strong>네트워크 및 액세스 제어 강화 (M1031 - Network Segmentation)</strong>  </p>

<ul>
<li><strong>네트워크 세분화</strong>를 통해 중요 시스템에 대한 <strong>원격 서비스 설치 및 변경</strong>을 제한  </li>
<li><strong>방화벽 및 포트 관리</strong>: 외부에서 불필요한 서비스에 접근할 수 없도록 방화벽을 설정하고, <strong>취약한 포트</strong>를 차단  </li>
<li><strong>서비스에 대한 원격 접근</strong>을 제한하고, <strong>VPN</strong>이나 <strong>암호화된 터널링</strong>을 통해서만 관리 접근 가능하도록 설정  </li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1543.003</td>
</tr>
<tr>
  <td style="text-align:center;">T1059.003</td>
</tr>
<tr>
  <td style="text-align:center;">T1569.002</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">Techniques name</td>
</tr>
</tbody>
</table>

</body>
</html>
