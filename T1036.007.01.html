<!DOCTYPE html>
<html>
<head>
    <title>T1036.007.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1036.007.01 double file extension</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<ul>
<li>Action = "CreateProcess" AND</li>
<li>Target<em>File</em>Exetention <End with> "exe" OR "lnk" OR "hta" OR "scr" OR "js"</li>
<li>Target<em>File</em>Name <Contain> ".bmp" OR ".doc" OR ".docx" OR ".gif" OR ".hlp" OR ".htm" OR ".html" OR ".jar" OR ".jpg" OR ".log" OR ".png" OR ".ppt" OR ".pptx" OR ".rar" OR ".rtf" OR ".swf" OR ".xls" OR ".xlsx" OR ".xml" OR ".css" OR ".bmp." OR ".doc." OR ".docx." OR ".gif." OR ".hlp." OR ".htm." OR ".html." OR ".jar." OR ".jpg." OR ".log." OR ".png." OR ".ppt." OR ".pptx." OR ".rar." OR ".rtf." OR ".swf." OR ".txt." OR ".xls." OR ".xlsx." OR ".xml." OR ".css."
<h3>Detection(EDR)</h3></li>
</ul>

<p><img src="T1036.007.01.PNG" alt="" />
https://172.18.10.125:8903/#/analysis/alert/66f3d441002dc795000000ef</p>

<h3>Response</h3>

<ol>
<li><p>시스템 분석 및 감염 여부 확인
다운로드된 파일의 확장자가 이중 확장자(ex: .txt.exe, .jpg.scr)를 가지고 있는지 확인하고, 이러한 파일이 실행된 시스템의 로그 및 히스토리를 조사하여 의심스러운 활동이 있었는지 확인합니다.
감염된 파일이 실행된 시스템에서 실행된 프로세스 목록을 확인하고, 의심스러운 프로세스가 실행 중이거나 최근에 종료된 경우 해당 프로세스를 격리하고 분석합니다.
시스템의 중요한 파일 및 레지스트리 변경 사항을 점검하여, 이중 확장자를 가진 실행 파일로 인해 시스템 설정이 변경되었는지 확인합니다.</p></li>
<li><p>네트워크 트래픽 및 파일 전송 경로 조사
다운로드된 파일이 네트워크를 통해 전송된 경우, 네트워크 트래픽 로그를 분석하여 파일이 전송된 경로와 출발지 및 목적지 IP 주소를 확인합니다.
파일이 전송된 네트워크 경로 및 서버를 추적하여, 동일한 파일이 다른 시스템에도 전송되었는지 확인하고, 필요한 경우 해당 네트워크 세그먼트나 서버를 격리합니다.
파일이 전송된 경로를 통해 추가적인 악성 파일이 다운로드되었는지 조사하고, 관련된 파일을 전부 탐지 및 격리하여 감염 확산을 방지합니다.</p></li>
<li><p>실행 파일 및 의심스러운 활동 포렌식 분석
이중 확장자를 가진 실행 파일을 안전한 분석 환경(샌드박스, 격리된 VM 등)에서 분석하여 악성 코드의 의도를 파악합니다. 파일의 동작, 네트워크 활동, 파일 생성 및 레지스트리 변경 사항 등을 조사합니다.
파일이 실행된 후 생성된 프로세스, DLL 로드, 파일 생성 및 변경, 네트워크 접속 시도 등 시스템 활동을 분석하여 공격자가 수행한 행동을 파악합니다.
파일이 시스템에 추가적으로 설치한 악성 프로그램이나 설정을 모두 파악하고, 이를 제거하거나 격리하여 시스템을 복구합니다.</p></li>
<li><p>손상된 시스템 격리 및 복구
이중 확장자를 가진 파일이 다운로드되었거나 실행된 시스템을 네트워크에서 격리하여 추가적인 악성 코드 확산 및 데이터 유출을 방지합니다.
감염된 시스템의 백업 및 로그를 통해 악성 코드가 설치되기 이전의 상태로 복원하거나, 전체 시스템을 초기화하고 중요한 데이터만 복구합니다.
악성 코드가 제거된 후 시스템을 최신 보안 패치 상태로 유지하고, 향후 동일한 공격이 발생하지 않도록 보안 정책을 강화합니다.</p></li>
<li><p>침해 사고 보고 및 추가적인 조치
침해 사고가 발생한 경우, 내부 보안 팀 및 법 집행 기관에 즉각적으로 보고하고, 침해 사고의 범위를 정확히 파악하여 추가적인 피해를 방지합니다.
공격자가 이중 확장자를 가진 파일을 다운로드 및 실행시키기 위해 사용한 기술(소셜 엔지니어링, 이메일 피싱 등)을 파악하고, 해당 기술에 대해 내부 직원들에게 교육을 실시하여 재발을 방지합니다.</p></li>
</ol>

<h3>Mitigations</h3>

<ol>
<li><p><strong>파일 확장자 및 실행 정책 강화</strong></p>

<ul>
<li>운영체제 및 파일 탐색기에서 파일 확장자를 항상 표시하도록 설정하여 이중 확장자(예: filename.txt.exe)로 위장한 파일을 쉽게 인식할 수 있도록 합니다.</li>
<li>웹 브라우저, 이메일 클라이언트, 파일 공유 프로그램 등에서 특정 확장자(예: .exe, .scr, .bat)를 포함한 파일의 자동 다운로드 및 실행을 차단하거나, 이러한 파일을 다운로드할 때 사용자에게 경고 메시지를 표시하도록 설정합니다.</li>
<li>조직 내 시스템에서 이중 확장자를 가진 파일의 실행을 차단하도록 그룹 정책(GPO) 또는 애플리케이션 제어(whitelisting) 솔루션을 설정합니다.</li>
</ul></li>
<li><p><strong>안티바이러스 및 EDR 솔루션 활용</strong></p>

<ul>
<li>최신 안티바이러스 및 EDR(Endpoint Detection and Response) 솔루션을 사용하여 이중 확장자 파일이나 악성 코드로 의심되는 파일을 실시간으로 탐지하고 차단하도록 합니다.</li>
<li>EDR 솔루션을 활용하여 파일의 다운로드 및 실행 내역을 모니터링하고, 비정상적인 파일 실행이나 네트워크 연결 시도를 감지하여 즉시 경고를 발생시키도록 설정합니다.</li>
<li>안티바이러스 및 EDR 솔루션의 서명 파일 및 정책을 주기적으로 업데이트하여 새로운 이중 확장자 파일 및 악성 코드에 대한 탐지 및 차단 능력을 강화합니다.</li>
</ul></li>
<li><p><strong>사용자 교육 및 인식 강화</strong></p>

<ul>
<li>직원들에게 이중 확장자 파일 및 파일 확장자 숨김 기능의 위험성에 대해 교육하고, 의심스러운 파일을 다운로드하거나 실행하지 않도록 안내합니다.</li>
<li>피싱 이메일, 악성 파일 다운로드 등의 공격 기법에 대한 정기적인 보안 인식 교육을 실시하여, 직원들이 공격자의 사회공학적 기법에 속지 않도록 합니다.</li>
<li>다운로드한 파일을 실행하기 전에 항상 신뢰할 수 있는 출처인지 확인하고, 의심스러운 경우 보안 부서에 보고하도록 하는 정책을 마련합니다.</li>
</ul></li>
<li><p><strong>이메일 및 웹 필터링 정책 설정</strong></p>

<ul>
<li>이메일 필터링 솔루션을 활용하여 악성 파일이 첨부된 이메일을 차단하거나, 의심스러운 확장자를 가진 파일 첨부 시 경고 메시지를 표시하여 사용자가 주의할 수 있도록 합니다.</li>
<li>웹 필터링 솔루션을 통해 의심스러운 파일이 포함된 웹사이트나 다운로드 링크를 차단하고, 직원들이 신뢰할 수 없는 웹사이트에서 파일을 다운로드하지 않도록 합니다.</li>
<li>웹 브라우저 및 이메일 클라이언트의 보안 설정을 강화하여, 악성 파일 다운로드 및 실행을 방지하고, 다운로드된 파일이 실행되기 전에 사용자의 확인을 요구하도록 설정합니다.</li>
</ul></li>
<li><p><strong>파일 무결성 검사 및 애플리케이션 제어</strong></p>

<ul>
<li>중요한 시스템 및 서버에 대해 파일 무결성 검사(FIM: File Integrity Monitoring)를 설정하여, 승인되지 않은 파일의 생성 및 변경을 탐지하고 이를 차단합니다.</li>
<li>애플리케이션 제어 솔루션(whitelisting)을 활용하여 승인된 애플리케이션만 실행될 수 있도록 설정하고, 승인되지 않은 이중 확장자 파일의 실행을 차단합니다.</li>
<li>시스템에 설치된 소프트웨어 및 파일의 무결성을 주기적으로 점검하여, 악성 코드나 의심스러운 파일이 설치되었는지 확인하고, 이를 탐지 및 제거합니다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1204.002</td>
</tr>
<tr>
  <td style="text-align:center;">T1059.003</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">Techniques name</td>
</tr>
</tbody>
</table>

</body>
</html>
