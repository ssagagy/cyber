<!DOCTYPE html>
<html>
<head>
    <title>T1588.002.06</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1588.002.06 상용 도구(rar.exe) 사용</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>Process Create AND Target File Description: Command line RAR AND CMD Line: *.rar</p>

<h3>Detection(EDR)</h3>

<p>EDR에 관련된 대응 방안을 작성</p>

<h3>Response</h3>

<p>자격 증명의 보호와 관리를 강화하고, 침해 탐지 및 모니터링을 통해 공격 시도를 실시간으로 감지하는 것이 중요합니다. 또한, 자격 증명 덤핑 도구의 활동을 탐지하고 차단할 수 있는 기술적 방어 수단을 마련하며, 사용자와 관리자의 보안 교육을 통해 조직 전체가 자격 증명 보호에 신경 쓸 수 있도록 하는 것이 필수적입니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>자격 증명 보호 및 강화</strong></p>

<ul>
<li>암호화된 자격 증명 저장
<ul>
<li>자격 증명을 암호화하여 저장하고, 해시 알고리즘(예: bcrypt, PBKDF2)을 사용하여 비밀번호를 안전하게 저장합니다.</li>
<li>이를 통해 공격자가 메모리에서 자격 증명을 덤프하더라도 의미 있는 정보를 얻지 못하게 만듭니다.</li>
</ul></li>
<li>자격 증명 관리 도구 사용
<ul>
<li>비밀번호 관리자나 권한 관리 시스템을 사용하여 자격 증명을 안전하게 저장하고 관리합니다.</li>
<li>이를 통해 사용자가 비밀번호를 직접 입력하지 않도록 하고, 비밀번호 관리의 중앙화를 통해 보안을 강화합니다.</li>
</ul></li>
<li>자격 증명 보호 정책 강화
<ul>
<li>암호화된 저장소를 사용하고, 시스템에서 자격 증명을 직접적으로 저장하지 않도록 합니다.</li>
<li>또한, 자격 증명에 대한 접근을 엄격히 제한합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>다단계 인증(MFA) 적용</strong></p>

<ul>
<li>MFA 적용
<ul>
<li>다단계 인증(Multi-Factor Authentication)을 모든 중요한 계정에 적용하여, 공격자가 자격 증명을 덤프하더라도 추가적인 인증 단계가 필요하도록 합니다.</li>
<li>MFA는 로그인 시 비밀번호 외에도 <strong>OTP(일회용 비밀번호)</strong>나 생체 인식 등을 추가로 요구합니다.</li>
</ul></li>
<li>특권 계정에 대한 강화된 MFA
<ul>
<li>특권 계정(예: 관리자 계정)에 대해 MFA를 필수로 적용하여, 공격자가 자격 증명 덤핑만으로는 시스템에 접근할 수 없도록 합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>자격 증명 덤핑 도구 탐지 및 차단</strong></p>

<ul>
<li>Mimikatz 및 자격 증명 덤핑 도구 탐지
<ul>
<li>Mimikatz와 같은 도구를 시스템에서 탐지하고 차단할 수 있는 <strong>침입 탐지 시스템(IDS/IPS)</strong>을 배포하여, 이러한 도구가 실행되는 것을 방지합니다.</li>
</ul></li>
<li>PowerShell 모니터링
<ul>
<li>PowerShell 스크립트와 명령어의 실행을 모니터링하고, 자격 증명 덤핑을 시도하는 명령어나 스크립트 실행을 차단합니다.</li>
<li>PowerShell 로그를 활성화하여 의심스러운 명령어를 추적할 수 있도록 합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>계정 및 권한 관리</strong></p>

<ul>
<li>최소 권한 원칙(Least Privilege) 적용
<ul>
<li>사용자가 필요한 최소한의 권한만을 갖도록 설정하여, 자격 증명 덤핑으로 얻은 정보로 시스템에 대한 권한 상승을 방지합니다.</li>
<li>각 계정은 작업에 필요한 권한만 부여받아야 합니다.</li>
</ul></li>
<li>특권 계정 관리(PAM)
<ul>
<li>특권 계정(관리자 계정 등)에 대한 <strong>PAM(Privileged Access Management)</strong>을 도입하여, 특권 계정의 비밀번호 및 인증 정보를 안전하게 관리하고, 필요할 때만 제한된 시간 동안 사용하도록 설정합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>시스템 보안 강화</strong></p>

<ul>
<li>Credential Guard 사용
<ul>
<li>Windows Credential Guard와 같은 기능을 활성화하여, 자격 증명이 메모리에 저장되지 않도록 보호합니다.</li>
<li>이 기능은 자격 증명을 하드웨어 기반으로 보호하여, 덤핑 도구가 이를 추출하지 못하도록 합니다.</li>
</ul></li>
<li>LSA 보호
<ul>
<li>Local Security Authority(LSA) 보호를 활성화하여, LSA 프로세스에서 자격 증명을 안전하게 보호하고, 자격 증명 덤핑 도구의 접근을 차단합니다.</li>
</ul></li>
<li>시스템에서 관리자 권한 제한
<ul>
<li>운영 체제에서 특권 계정을 제한하여 자격 증명 덤핑 공격자가 이를 얻었을 때 피해를 최소화합니다.</li>
<li>직접적인 관리자 권한을 사용하지 않도록 하고, 관리 작업은 안전한 절차로 처리합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>침해 탐지 및 모니터링 강화</strong></p>

<ul>
<li>로그 모니터링
<ul>
<li>자격 증명 덤핑 도구나 공격 활동을 추적할 수 있는 로그를 실시간으로 모니터링하고, 비정상적인 로그인 시도, 자격 증명 변경, 로그인 실패 등을 감지하여 경고를 발생시킵니다.</li>
</ul></li>
<li>고급 침입 탐지
<ul>
<li>HIPS/IDS(Host-based Intrusion Prevention/Detection System)와 SIEM(Security Information and Event Management) 시스템을 사용하여 자격 증명 덤핑 도구의 실행과 같은 의심스러운 활동을 실시간으로 탐지하고 차단합니다.</li>
</ul></li>
<li>시스템 로그 감사
<ul>
<li>자격 증명 덤핑 시도와 관련된 시스템 로그(예: Event Logs, Audit Logs)를 주기적으로 감사하고, 자격 증명이 변경되거나, Mimikatz와 같은 도구가 실행된 흔적을 추적합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>침해 사고 대응 및 복구 계획</strong></p>

<ul>
<li>긴급 대응 절차 마련
<ul>
<li>자격 증명 덤핑이 발생했을 때 즉각적으로 대응할 수 있는 침해 사고 대응 절차를 마련합니다.</li>
<li>비밀번호를 변경하고, 피해를 최소화할 수 있도록 빠르게 계정을 잠그고, 시스템을 복구할 수 있는 절차를 마련합니다.</li>
</ul></li>
<li>계정 및 자격 증명 복구
<ul>
<li>자격 증명 덤핑으로 인해 계정 정보가 유출되었다면, 해당 계정의 비밀번호를 변경하고, 특권 계정의 권한을 재검토하여 피해를 최소화합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>보안 교육 및 인식 강화</strong></p>

<ul>
<li>사용자 보안 교육
<ul>
<li>사용자들에게 비밀번호 보안 및 피싱 공격에 대해 교육하고, 자격 증명 보호의 중요성을 인식시킵니다.</li>
<li>강력한 비밀번호를 설정하고, 사회공학적 공격을 방어할 수 있도록 훈련시킵니다.</li>
</ul></li>
<li>관리자 및 개발자 교육
<ul>
<li>관리자들에게 자격 증명 덤핑 공격 및 그에 대한 대응 방법에 대해 교육을 제공하고, 개발자에게도 안전한 인증 및 권한 관리 시스템을 구축할 수 있도록 합니다.</li>
</ul></li>
</ul></li>
<li><p><strong>네트워크 및 시스템 세분화</strong></p>

<ul>
<li>네트워크 세분화
<ul>
<li>네트워크를 세분화하여 민감한 시스템을 다른 시스템과 격리하고, 공격자가 자격 증명 덤핑을 통해 획득한 정보로 다른 시스템에 접근할 수 없도록 합니다.</li>
</ul></li>
<li>방화벽 및 네트워크 접근 제어
<ul>
<li>네트워크 방화벽을 사용하여 내부 시스템 간의 불필요한 접근을 제한하고, 자격 증명이 유출된 경우 네트워크를 통해 확산되는 것을 방지합니다.</li>
</ul></li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1560.001</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-PM Platform Monitoring</td>
</tr>
<tr>
  <td style="text-align:center;">D3-PSA Process Spawn Analysis</td>
</tr>
</tbody>
</table>

</body>
</html>
