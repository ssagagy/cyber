<!DOCTYPE html>
<html>
<head>
    <title>T1053.005.02</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1053.005.02 그룹정책(GPO)에 의해 와이퍼 악성코드를 실행하는 스케줄 등록</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>Azure AD 환경에서 그룹정책(GPO)으로 자동 실행 등록을 통해 의심스러운 프로세스를 작업 스케줄러에 등록하는 명령을 탐지합니다.</p>

<h3>Detection(EDR)</h3>

<p><img src="T1053.005.02.png" alt="" /></p>

<h3>Response</h3>

<ol>
<li>Windows 이벤트 로그 모니터링:</li>
</ol>

<p>작업 스케줄링과 관련된 이벤트를 모니터링합니다.</p>

<ol start="2">
<li>이벤트 로그 활성화:</li>
</ol>

<p>작업 스케줄러 이벤트 로그를 활성화합니다.</p>

<ol start="3">
<li>이상 징후 탐지:</li>
</ol>

<p>예약된 작업 이름이 의심스러운 경우 탐지합니다.</p>

<ol start="4">
<li>SIEM 기반 모니터링:</li>
</ol>

<p>Splunk, Microsoft Sentinel, ELK Stack 등을 사용하여 작업 생성 이벤트를 실시간으로 탐지합니다.</p>

<ol start="5">
<li>파일 무결성 검사:</li>
</ol>

<p>작업 스케줄러 구성 파일(C:\Windows\System32\Tasks)의 무결성을 주기적으로 검사하여 비정상적인 작업 추가 여부를 확인합니다.</p>

<ol start="6">
<li>네트워크 트래픽 분석:</li>
</ol>

<p>작업 예약이 네트워크 기반 명령 실행을 유발할 수 있으므로 네트워크 트래픽을 모니터링하여 비정상적인 아웃바운드 요청을 탐지합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>at.exe 비활성화 또는 제거</strong></p>

<ul>
<li>at.exe는 더 이상 Windows에서 기본 스케줄링 도구로 권장되지 않으며, PowerShell 및 schtasks.exe로 대체되었습니다. 필요하지 않으면 at.exe 실행 파일을 제거하거나 비활성화합니다.</li>
</ul></li>
<li><p><strong>작업 스케줄러 권한 제어</strong></p>

<ul>
<li>관리자 권한 계정만 작업을 생성하거나 관리하도록 제한합니다, 로컬 그룹 정책 편집기(Gpedit.msc) &gt; 컴퓨터 구성 &gt; Windows 설정 &gt; 보안 설정 &gt; 로컬 정책 &gt; 사용자 권한 할당에서 "작업 예약 생성 및 관리" 항목을 수정하여 권한을 최소화합니다.</li>
</ul></li>
<li><p><strong>AppLocker 또는 WDAC 정책 사용</strong></p>

<ul>
<li>at.exe 또는 관련 스크립트를 실행하지 못하도록 차단합니다.</li>
</ul></li>
<li><p><strong>Windows Defender Exploit Guard</strong></p>

<ul>
<li>Attack Surface Reduction(ASR) 규칙을 활성화하여 악성 작업 예약 시도를 차단합니다.</li>
</ul></li>
<li><p><strong>최소 권한 원칙 적용</strong></p>

<ul>
<li>비관리자 계정은 작업 스케줄링 권한이 없도록 정책을 설정합니다.</li>
</ul></li>
<li><p><strong>PowerShell Script Logging 활성화</strong></p>

<ul>
<li>PowerShell을 사용한 작업 예약 시도를 기록하도록 설정합니다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1053.005.02</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-SJA Scheduled Job Analysis</td>
</tr>
</tbody>
</table>

</body>
</html>
