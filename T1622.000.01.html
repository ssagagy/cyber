<!DOCTYPE html>
<html>
<head>
    <title>T1622.000.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1622.000.01 디버거 프로그램 탐지</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>powershell.exe가 디버거 프로그램을 탐지하는 명령을 탐지합니다.</p>

<h3>Detection(EDR)</h3>

<p><img src="T1622.000.01.png" alt="" /></p>

<h3>Response</h3>

<ol>
<li>WMI 쿼리 로그 확인:</li>
</ol>

<p>WMI 쿼리 실행이 있을 때 Event ID 5858 이벤트가 기록됩니다. 쿼리 실행이 의심스러울 경우 이를 분석하여 WMI를 통해 Office 응용 프로그램을 실행하려는 시도를 탐지합니다.</p>

<ol start="2">
<li>PowerShell 명령 추적:</li>
</ol>

<p>PowerShell에서 Get-WmiObject 또는 Invoke-WmiMethod와 같은 WMI 명령어가 사용되었는지 추적합니다. WMI를 통한 명령 실행을 모니터링하려면 PowerShell 스크립트 블록 로깅을 활성화합니다.</p>

<ol start="3">
<li>SIEM 도구 및 로그 분석:</li>
</ol>

<p>SIEM 도구에서 WMI 쿼리나 PowerShell을 통한 의심스러운 활동을 실시간으로 모니터링하여 경고를 생성하고 Splunk 또는 Microsoft Sentinel에서 "wmic" 또는 "Get-WmiObject"를 포함한 명령을 추적하여 의심스러운 명령을 탐지합니다.</p>

<ol start="4">
<li>Sysmon을 통한 WMI 탐지:</li>
</ol>

<p>Sysmon에서 Event ID 20을 사용하여 WMI와 관련된 활동을 기록하고 모니터링할 수 있습니다. WMI를 통해 Office 응용 프로그램이 시작되는 이벤트를 추적할 수 있습니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>WMI 권한 최소화</strong></p>

<ul>
<li>WMI 리소스에 대한 액세스를 제한하여 불필요한 권한을 가진 사용자가 악용하지 않도록 합니다.</li>
<li>특정 그룹과 사용자만 WMI 작업을 실행할 수 있도록 설정합니다.</li>
</ul></li>
<li><p><strong>WMI 쿼리 및 이벤트 모니터링</strong></p>

<ul>
<li>이벤트 로그를 사용하여 WMI 관련 활동을 모니터링합니다.</li>
<li>이를 통해 악성 스크립트나 의심스러운 Office 프로그램 실행을 탐지할 수 있습니다.</li>
</ul></li>
<li><p><strong>매크로 보안 강화</strong></p>

<ul>
<li>Microsoft Office에서 매크로를 기본적으로 비활성화하고, 신뢰할 수 없는 매크로의 실행을 막습니다.</li>
<li>그룹 정책을 통해 이를 관리할 수 있습니다.</li>
</ul></li>
<li><p><strong>Windows Defender 및 EDR(Endpoint Detection and Response) 활용</strong></p>

<ul>
<li>Office 응용 프로그램을 통한 악성 코드 실행을 탐지하기 위해 Windows Defender 및 EDR 솔루션을 활성화하여 의심스러운 파일이나 매크로 활동을 실시간으로 모니터링합니다.</li>
</ul></li>
<li><p><strong>AppLocker 사용</strong></p>

<ul>
<li>특정 Office 응용 프로그램이나 파일을 실행하지 못하도록 AppLocker를 통해 제한합니다.</li>
<li>예를 들어, PowerShell 또는 WMI를 통한 실행을 방지할 수 있습니다.</li>
</ul></li>
<li><p><strong>PowerShell 스크립트 실행 제한</strong></p>

<ul>
<li>PowerShell을 통한 악성 WMI 명령 실행을 차단하려면 PowerShell 실행 정책을 제한합니다.</li>
</ul></li>
<li><p><strong>스크립트 차단</strong></p>

<ul>
<li>PowerShell 또는 CMD 명령을 통해 악성 스크립트가 실행되는 것을 방지합니다.</li>
<li>WMI를 통해 제어되는 스크립트를 차단할 수 있습니다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1622</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-FIM File Integrity Monitoring</td>
</tr>
<tr>
  <td style="text-align:center;">D3-PLA Process Lineage Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-DA Dynamic Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-EFA Emulated File Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-PM Platform Monitoring</td>
</tr>
<tr>
  <td style="text-align:center;">D3-PSA Process Spawn Analysis</td>
</tr>
</tbody>
</table>

</body>
</html>
