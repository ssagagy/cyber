<!DOCTYPE html>
<html>
<head>
    <title>T1049.000.03</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1049.000.03 시스템네트워크연결식별</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<ul>
<li>netstat, who 명령을 이용하여 시스템이 연결 중인 네트워크를 식별하는 행위를 탐지합니다.</li>
<li>Action = "CreateProcess" AND</li>
<li>TargetProcess = "netstat" OR "who"</li>
</ul>

<h3>Detection(EDR)</h3>

<p><img src="T1049.000.03.png" alt="" /></p>

<h3>Response</h3>

<ol>
<li>네트워크 트래픽 분석: </li>
</ol>

<p>네트워크 연결 탐색 활동을 감지하기 위해 시스템에서 발생하는 네트워크 트래픽을 분석합니다. 비정상적인 연결 시도나 네트워크 스캐닝 활동이 있는지 확인합니다.</p>

<ol start="2">
<li>Wireshark, NetFlow 등 사용: </li>
</ol>

<p>Wireshark나 NetFlow와 같은 도구를 사용해 비정상적인 네트워크 패킷과 연결 시도를 캡처하고 분석합니다.</p>

<ol start="3">
<li>네트워크 명령 실행 기록 분석: </li>
</ol>

<p>공격자가 netstat, ss, ifconfig 등과 같은 명령어를 실행하여 네트워크 연결 정보를 수집했는지 확인하기 위해 시스템 로그를 분석합니다.</p>

<ol start="4">
<li>네트워크 세션 상태 조사: </li>
</ol>

<p>공격자가 어떤 네트워크 연결 정보를 수집했는지 확인하기 위해 현재 활성화된 네트워크 연결 세션을 조사합니다.</p>

<ol start="5">
<li>비정상적인 네트워크 연결 차단: </li>
</ol>

<p>공격자가 네트워크 정보를 수집하고 추가적으로 액세스하려는 시도가 감지되면, 해당 연결을 즉시 차단합니다.</p>

<ol start="6">
<li>비정상적인 프로세스 탐지: </li>
</ol>

<p>시스템에서 비정상적인 네트워크 연결 탐색을 수행한 프로세스를 식별하고, 해당 프로세스를 분석합니다.</p>

<ol start="7">
<li>악성 소프트웨어 제거: </li>
</ol>

<p>네트워크 탐색에 사용된 악성 프로그램이나 스크립트를 식별한 후 제거합니다.</p>

<ol start="8">
<li>메모리 및 디스크 포렌식: </li>
</ol>

<p>메모리 덤프를 분석하여 공격자가 네트워크 연결 정보를 수집하기 위해 사용한 툴이나 명령어를 확인합니다.</p>

<ol start="9">
<li>파일 시스템 분석: </li>
</ol>

<p>로그 파일이나 임시 파일을 조사하여 네트워크 연결 정보가 기록되었는지 확인하고, 공격자가 수집한 데이터를 추적합니다.</p>

<ol start="10">
<li>네트워크에서 시스템 격리: </li>
</ol>

<p>공격자가 시스템의 네트워크 연결 정보를 수집하고 추가적인 공격을 시도하려는 것이 확인될 경우, 해당 시스템을 네트워크에서 격리하여 추가 피해를 방지합니다.</p>

<ol start="11">
<li>시스템 복구 및 리소스 제한: </li>
</ol>

<p>피해 시스템을 복구하고, 네트워크 탐색에 사용될 수 있는 서비스나 프로세스를 비활성화하거나 제한합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>네트워크 트래픽 필터링</strong> </p>

<ul>
<li>방화벽을 통해 외부에서 내부 시스템으로의 불필요한 네트워크 연결을 제한하고, 네트워크 스캐닝이나 탐색 시도를 차단합니다.</li>
</ul></li>
<li><p><strong>IDS/IPS 설정</strong> </p>

<ul>
<li>침입 탐지 시스템(IDS) 또는 침입 방지 시스템(IPS)을 활용해 비정상적인 네트워크 연결 탐색 시도를 탐지하고 차단합니다.</li>
</ul></li>
<li><p><strong>필요한 포트만 열기</strong> </p>

<ul>
<li>네트워크 탐색에 사용될 수 있는 비필수 포트는 닫고, 필요한 포트만 열어두어 불필요한 네트워크 정보 노출을 방지합니다.</li>
</ul></li>
<li><p><strong>원격 관리 제한</strong> </p>

<ul>
<li>SSH, RDP 등 원격 관리 프로토콜의 접근을 제한하고, 접근 가능한 사용자와 네트워크를 엄격히 관리합니다.</li>
</ul></li>
<li><p><strong>최소 권한 원칙 적용</strong> </p>

<ul>
<li>시스템에 대한 네트워크 연결 탐색 권한을 제한하여, 불필요한 사용자나 프로세스가 네트워크 연결 정보를 수집하지 못하도록 합니다.</li>
</ul></li>
<li><p><strong>관리자 권한 제한</strong> </p>

<ul>
<li>네트워크 설정 및 연결 정보를 조회할 수 있는 관리자 권한이 필요한 명령어를 사용하는 것을 제한하고, 사용자 권한을 최소한으로 설정합니다.</li>
</ul></li>
<li><p><strong>네트워크 연결 관련 이벤트 로그 활성화</strong> </p>

<ul>
<li>시스템에서 발생하는 네트워크 연결 시도를 모니터링하기 위해 Windows와 Linux 시스템 모두에서 네트워크 연결 관련 이벤트 로깅을 활성화합니다.</li>
</ul></li>
<li><p><strong>SIEM 사용</strong> </p>

<ul>
<li>네트워크 연결 탐색 시도를 중앙에서 모니터링할 수 있도록 SIEM(Security Information and Event Management) 시스템을 활용하여 실시간 경고를 설정합니다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1049.000</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-NTA Network Traffic Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-NTF Network Traffic Filtering</td>
</tr>
<tr>
  <td style="text-align:center;">D3-ITF Inbound Traffic Filtering</td>
</tr>
<tr>
  <td style="text-align:center;">D3-OTF Outbound Traffic Filtering</td>
</tr>
</tbody>
</table>

</body>
</html>
