<!DOCTYPE html>
<html>
<head>
    <title>T1003.006.02</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1003.006.02 DCSync 자격증명 덤프</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>Action = "AMSI<em>SCAN" AND
CurrntProcess = "powershell.exe" AND
AMSI</em>SCAN<em>DATA = "Get-ADReplAccount" AND
AMSI</em>SCAN<em>DATA = "-All" AND
AMSI</em>SCAN_DATA = "Server"</p>

<h3>Detection(EDR)</h3>

<p><img src="T1003.006.02.png" alt="T1003_006_02" /></p>

<h3>Response</h3>

<ol>
<li>LSASS 접근 탐지:</li>
</ol>

<p>LSASS 프로세스 메모리 접근 시도를 탐지하려면 Windows 이벤트 로그를 모니터링합니다.</p>

<ol start="2">
<li>PowerShell 로그 모니터링:</li>
</ol>

<p>PowerShell 스크립트를 사용한 자격 증명 추출 시도를 감지합니다.</p>

<ol start="3">
<li>메모리 덤프 파일 탐지:</li>
</ol>

<p>LSASS 메모리 덤프와 관련된 파일을 탐지합니다. 예를 들어 .dmp 파일이 비정상적인 경로에 저장되는지 확인합니다.</p>

<ol start="4">
<li>침해지표(IOC) 탐지:</li>
</ol>

<p>Mimikatz와 같은 도구로 인해 생성된 흔적을 탐지합니다:</p>

<h3>Mitigations</h3>

<ol>
<li>LSASS 프로세스 보호:</li>
</ol>

<p>LSASS(Local Security Authority Subsystem Service) 프로세스는 Windows 자격 증명을 저장합니다. 공격자들이 LSASS 메모리를 덤프하거나 읽는 것을 방지해야 합니다.</p>

<ol start="2">
<li>최소 권한 원칙 적용:</li>
</ol>

<p>관리자가 아닌 계정에 LSASS 접근 권한을 제한합니다, 관리 계정을 보호하고 이중 인증(MFA)을 활성화합니다.</p>

<ol start="3">
<li>Windows Defender 및 Endpoint Protection:</li>
</ol>

<p>Windows Defender ATP(Advanced Threat Protection) 또는 Microsoft Defender를 사용하여 메모리 관련 악성 활동을 탐지합니다.</p>

<ol start="4">
<li>패치 관리:</li>
</ol>

<p>Windows 보안 업데이트를 정기적으로 적용하여 자격 증명 관련 취약점을 제거합니다.</p>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1003.006</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-CCSA Credential Compromise Scope Analysis</td>
</tr>
</tbody>
</table>

</body>
</html>
