<!DOCTYPE html>
<html>
<head>
    <title>T1036.004.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1036.004.01 Masquerading: Masquerade Task or Service</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>N/A</p>

<h3>Detection(EDR)</h3>

<p>N/A</p>

<h3>Response</h3>

<ol>
<li><p>의심스러운 서비스 및 프로세스 분석
시스템에서 실행 중인 서비스와 프로세스를 모니터링하고, 시스템 기본 서비스와 비슷한 이름을 사용하지만 실제로는 불필요하거나 예상치 못한 동작을 하는 서비스를 식별합니다.
의심스러운 서비스나 프로세스를 발견하면 해당 프로세스의 실행 파일 경로, 서명 정보, 네트워크 연결 등을 확인하고, 악성 코드일 가능성을 평가합니다.
악성 행위가 의심되는 서비스나 프로세스는 메모리 덤프를 생성하거나 파일을 분석하여 추가적인 조사를 수행합니다.</p></li>
<li><p>이벤트 로그 및 실행 기록 분석
Windows 이벤트 로그(Security, System, Application 로그)에서 의심스러운 서비스 설치 및 시작 이벤트를 추적합니다.
서비스 설치 시점 및 설치한 사용자, 관리자 권한 사용 여부 등을 확인하여 공격자의 행위를 파악합니다.
실행된 프로세스와 관련된 로그를 수집하고, 정상적이지 않은 서비스 이름을 사용한 프로세스의 실행 기록을 분석하여 추가적인 악성 활동을 조사합니다.</p></li>
<li><p>포렌식 분석 및 감염된 시스템 격리
의심스러운 서비스나 프로세스를 사용하는 시스템을 격리하여 추가적인 악성 행위가 네트워크에 전파되지 않도록 합니다.
해당 시스템의 포렌식 조사를 통해 악성 코드의 실행 방식, 서비스 설치 경로, 레지스트리 수정 내용 등을 분석하고 공격의 전후 상황을 파악합니다.
감염된 시스템의 메모리 덤프와 디스크 이미지를 확보하여 악성 코드의 행동을 파악하고, 추가적인 악성 코드가 존재하는지 확인합니다.</p></li>
<li><p>유사 이름 사용 서비스 목록화 및 모니터링 강화
정상적인 서비스와 유사한 이름을 사용하는 서비스의 목록을 생성하고, 해당 목록을 기반으로 유사한 이름을 가진 서비스가 새롭게 등록될 때마다 경고를 발생시키도록 설정합니다.
악성 코드가 정상적인 서비스와 유사한 이름을 사용하는 것을 방지하기 위해, 관리자 권한으로 서비스 등록 시 허용된 서비스 이름만 사용할 수 있도록 정책을 설정합니다.
서비스 설치 및 시작과 관련된 의심스러운 동작이 탐지되면, 관리자에게 즉시 알림을 보내고, 해당 서비스에 대한 접근 및 실행을 차단합니다.</p></li>
<li><p>보안 사고 대응팀(SOC) 및 관련 부서와의 협력
보안 사고 대응팀(SOC)과 협력하여 의심스러운 서비스 및 프로세스의 활동을 모니터링하고, 공격자의 의도를 파악합니다.
감염된 시스템이 확인되면 관련 부서와 협력하여 추가적인 분석을 수행하고, 감염의 확산을 방지할 수 있는 조치를 취합니다.
내부적으로 보안 경고 및 알림을 공유하여, 다른 시스템에서도 유사한 서비스나 프로세스가 발견될 경우 신속하게 대응할 수 있도록 준비합니다.</p></li>
</ol>

<h3>Mitigations</h3>

<ol>
<li><p><strong>서비스 및 프로세스 실행 권한 제한</strong></p>

<ul>
<li>관리자 권한으로만 서비스 등록 및 관리가 가능하도록 설정하여, 일반 사용자가 악성 서비스를 등록하지 못하도록 제한합니다.
서비스 실행 파일의 경로를 제한하여, 신뢰할 수 없는 경로에서 실행되는 서비스가 등록되지 않도록 설정합니다.</li>
</ul></li>
<li><p><strong>악성 서비스 이름 차단 및 허용 목록 설정</strong></p>

<ul>
<li>정상적인 서비스 이름과 유사한 이름을 가진 서비스가 등록되지 않도록 차단 목록을 설정하고, 해당 이름을 사용한 서비스 설치를 방지합니다.</li>
<li>허용된 서비스 이름 목록을 설정하고, 이 목록에 없는 이름으로 서비스가 등록되면 즉시 경고가 발생하도록 설정합니다.</li>
</ul></li>
<li><p><strong>보안 업데이트 및 패치 관리</strong></p>

<ul>
<li>운영 체제 및 애플리케이션의 최신 보안 패치를 적용하여, 공격자가 악성 서비스를 등록하기 위해 사용하는 취약점을 제거합니다.</li>
<li>자동 업데이트 기능을 활성화하여, 새롭게 발견된 취약점이 빠르게 패치될 수 있도록 설정합니다.</li>
</ul></li>
<li><p><strong>SIEM 및 EDR 솔루션 활용</strong></p>

<ul>
<li>SIEM(Security Information and Event Management) 솔루션을 사용하여 서비스 및 프로세스 실행과 관련된 모든 로그를 수집하고, 의심스러운 동작을 탐지할 수 있는 규칙을 설정합니다.</li>
<li>EDR(Endpoint Detection and Response) 솔루션을 사용하여 시스템에서 발생하는 모든 활동을 모니터링하고, 의심스러운 프로세스나 서비스가 탐지되면 자동으로 차단하거나 경고를 발생시킵니다.</li>
</ul></li>
<li><p><strong>사용자 교육 및 인식 제고</strong></p>

<ul>
<li>내부 사용자들에게 정상적인 서비스 이름과 유사한 이름을 사용한 악성 행위에 대해 교육하고, 의심스러운 서비스나 프로세스가 발견될 경우 즉시 보안 부서에 보고하도록 안내합니다.</li>
<li>관리자가 아닌 사용자가 의심스러운 서비스나 프로세스를 발견했을 때 이를 안전하게 보고할 수 있는 절차를 마련하고, 보고된 정보를 기반으로 추가적인 분석을 수행할 수 있도록 준비합니다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1059.001</td>
</tr>
<tr>
  <td style="text-align:center;">T1569.002</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-SICA System Init Config Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-FIM File Integrity Monitoring</td>
</tr>
<tr>
  <td style="text-align:center;">D3-FA File Analysis</td>
</tr>
</tbody>
</table>

</body>
</html>
