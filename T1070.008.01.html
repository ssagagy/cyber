<!DOCTYPE html>
<html>
<head>
    <title>T1070.008.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1070.008.01 Indicator Removal: Clear Mailbox Data</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>특정 파일 삭제 행위를 탐지하기 위해서 시스템의 로그 및 파일 엑세스 이벤트를 모니터링 해야한다.</p>

<ol>
<li>파일 시스템 이벤트 로그 모니터링 : Windows에서는 파일 삭제와 관련된 이벤트를 기록할 수 있다. 이벤트 로그에서 Event ID 4660 및 4663를 활용하여 특정 파일 삭제를 추적한다.</li>
<li>파일 무결성 모니터링 : 파일 무결성 모니터링 도구(예: OSSEC, Tripwire)를 사용하여 중요한 파일 및 디렉토리에 대한 무결성을 검증한다. 파일 삭제 또는 수정 시 경고를 발생시킬 수 있다.</li>
<li>사용자 명령어 로그 분석 : 사용자 명령어 이력을 기록하고 분석하여 특정 사용자 계정이 비정상적으로 해당 파일을 삭제한 경우를 탐지한다. PowerShell 또는 CMD의 실행 기록을 확인할 수 있다.</li>
</ol>

<h3>Detection(EDR)</h3>

<p><img src="캡처.PNG" alt="" /></p>

<h3>Response</h3>

<ol>
<li>해당 프로세스 종료 : 삭제를 수행한 프로세스를 식별하고 종료하여 추가적인 파일 삭제를 방지한다.</li>
<li>로그 및 증거 수집 : 삭제된 파일과 관련된 로그 및 시스템 상태를 기록하여 포렌식 분석을 위한 증거를 수집한다. 이를 통해 공격 경로 및 범위를 파악할 수 있다.</li>
<li>시스템 격리 : 해당 시스템을 네트워크에서 격리하여 추가적인 데이터 유출이나 공격을 방지한다. 이후 포렌식 분석을 통해 공격의 원인을 파악한다.</li>
<li>사용자 통지 및 교육 : 삭제된 파일과 관련된 사용자에게 상황을 통지하고, 보안 인식을 강화하기 위한 교육을 제공한다. 공격 기법에 대한 이해를 높여 유사 사건을 예방할 수 있도록 한다.</li>
</ol>

<h3>Mitigations</h3>

<ol>
<li><p><strong>정기적인 백업 수행</strong></p>

<ul>
<li>시스템 및 중요한 파일의 정기적인 백업을 수행하여 파일 손실에 대비한다.</li>
<li>복구가 가능하도록 백업 파일을 안전한 장소에 저장한다.</li>
</ul></li>
<li><p><strong>파일 시스템 보호 설정</strong></p>

<ul>
<li>파일 시스템에 대한 접근 권한을 설정하여 일반 사용자 계정이 중요 파일을 삭제하지 못하도록 제한한다.</li>
<li>파일 보호 및 백업 솔루션을 도입할 수 있다.</li>
</ul></li>
<li><p><strong>침입 탐지 시스템(IDS) 및 침입 방지 시스템(IPS) 사용</strong></p>

<ul>
<li>IDS 및 IPS를 활용하여 비정상적인 파일 삭제 이벤트를 실시간으로 모니터링하고 차단한다.</li>
<li>경고를 통해 신속한 대응이 가능하도록 한다.</li>
</ul></li>
<li><p><strong>시스템 및 소프트웨어 업데이트</strong></p>

<ul>
<li>운영체제와 모든 애플리케이션의 보안 업데이트를 정기적으로 수행하여 취약점을 최소화한다.</li>
</ul></li>
<li><p><strong>사용자 교육 및 인식 강화</strong></p>

<ul>
<li>사용자가 중요 파일의 삭제에 대한 위험성을 이해하도록 교육한다.</li>
<li>특정 파일 삭제의 필요성을 알리고, 비정상적인 활동을 신고하도록 유도한다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1070.008</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-FIM File Integrity Monitoring</td>
</tr>
<tr>
  <td style="text-align:center;">D3-SCA System Call Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-PM Platform Monitoring</td>
</tr>
</tbody>
</table>

</body>
</html>
