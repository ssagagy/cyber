<!DOCTYPE html>
<html>
<head>
    <title>T1057.000.02</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1057.000.02 프로세스 검색</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>tasklist 커맨드를 탐지한다.</p>

<h3>Detection(EDR)</h3>

<p><img src="T1057.000.02.png" alt="T1057 000 02" /></p>

<h3>Response</h3>

<p>시스템에서 비정상적인 프로세스 탐색 활동을 모니터링하고 의심스러운 행동을 신속히 조사합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>WMI 권한 제한 및 모니터링 (M1026 - Privileged Account Management)</strong>  </p>

<ul>
<li><strong>WMI 명령을 실행할 수 있는 권한을 최소화</strong>하여 비관리자 계정의 사용을 제한  </li>
<li><strong>WMI 쿼리 및 실행 권한을 관리자 계정으로만 제한</strong>  </li>
<li>WMI에 대한 <strong>읽기 및 쓰기 권한을 최소한의 사용자에게만 부여</strong>  </li>
<li>WMI 네임스페이스 및 객체에 대한 <strong>액세스 제어</strong> 설정을 강화  </li>
</ul></li>
<li><p><strong>WMI 이벤트 모니터링 및 경고 (M1047 - System Logging &amp; Monitoring)</strong>  </p>

<ul>
<li><strong>WMI 이벤트 및 쿼리의 실행을 모니터링</strong>하고, WMI를 통한 의심스러운 명령 실행을 추적  </li>
<li>Sysmon(Event ID 18)을 활용하여 <strong>WMI 이벤트 생성 및 실행 탐지</strong>  </li>
<li><code data-language="powershell">wmic.exe</code> 및 <code data-language="powershell">powershell.exe</code> 명령 실행에 대한 <strong>경고 및 로깅</strong> 활성화  </li>
<li><strong>Windows 이벤트 로그</strong>를 통해 WMI 관련 이벤트(ID 5858, 5859, 5860 등)를 추적하고 분석  </li>
</ul></li>
<li><p><strong>WMI 관련 도구 사용 제한 (M1038 - Execution Prevention)</strong>  </p>

<ul>
<li><code data-language="powershell">wmic.exe</code>, <code data-language="powershell">powershell.exe</code> 등 WMI와 관련된 도구 사용을 <strong>제한하거나 화이트리스트 설정</strong>  </li>
<li>비인가된 도구나 스크립트가 WMI를 통해 악성 명령을 실행하지 못하도록 <strong>권한 및 실행 제한</strong>  </li>
<li><strong>AppLocker</strong> 또는 <strong>WDAC(Windows Defender Application Control)</strong>를 사용하여 승인된 도구만 실행 허용  </li>
</ul></li>
<li><p><strong>WMI 관리 도구 및 서비스 보호 (M1043 - Code Signing)</strong>  </p>

<ul>
<li><strong>WMI 서비스</strong>(<code data-language="powershell">winmgmt.exe</code>)와 관련된 프로세스 및 도구에 대해 <strong>디지털 서명 및 인증</strong> 강화  </li>
<li><strong>WMI 서비스의 시작 및 종료 이벤트를 로깅</strong>하고, 비정상적인 접근을 감지하여 차단  </li>
<li><strong>WMI 프로바이더</strong>와 관련된 리소스에 대한 접근을 차단하여 <strong>불필요한 서비스 비활성화</strong>  </li>
</ul></li>
<li><p><strong>PowerShell 및 스크립트 실행 제한 (M1038 - Execution Prevention)</strong>  </p>

<ul>
<li><strong>PowerShell 스크립트 실행 정책을 엄격히 설정</strong>하여 WMI를 통한 PowerShell 실행을 제한  </li>
<li>PowerShell <strong>Constrained Language Mode</strong> 활성화 및 <strong>스크립트 블록 로깅</strong>을 통해 <strong>악성 스크립트 탐지</strong>  </li>
<li><strong>AppLocker</strong> 또는 <strong>WDAC</strong>를 활용하여 WMI 관련 스크립트가 의도하지 않은 명령을 실행하지 않도록 차단  </li>
</ul></li>
<li><p><strong>EDR/XDR 솔루션을 통한 악성 WMI 탐지 (M1040 - Behavior-Based Detection)</strong>  </p>

<ul>
<li><strong>EDR/XDR 솔루션</strong>을 활용하여 WMI를 통한 악성 활동 탐지 및 차단  </li>
<li><strong>WMI에서 비정상적인 스크립트 실행, 명령 생성 또는 서비스 변경</strong> 활동을 실시간으로 모니터링  </li>
<li><strong>WMI 쿼리 및 실행의 비정상적인 패턴</strong>을 식별하여 경고 알림을 설정  </li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1057.000</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-PM Platform Monitoring</td>
</tr>
<tr>
  <td style="text-align:center;">D3-PLA Process Lineage Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-SCA System Call Analysis</td>
</tr>
</tbody>
</table>

</body>
</html>
