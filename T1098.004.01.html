<!DOCTYPE html>
<html>
<head>
    <title>T1098.004.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1098.004 Account Manipulation SSH Authorized Keys</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<ul>
<li>Action = "FileCreate" OR "FileModify" AND</li>
<li>TargetPath <Contain> "/.ssh/authorized_keys" AND</li>
<li>TargetPath <begins not with> "/var/lib/containerd/"
<h3>Detection(EDR)</h3></li>
</ul>

<p><img src="EDR사진.png" alt="EDR사진 (3)" /></p>

<h3>Response</h3>

<p>공격자에 의해 PC가 제어되었을 가능성이 있으므로 호스트 네트워크를 격리합니다.
공격자가 생성한 파일을 삭제합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>SSH 키 관리 및 모니터링</strong>  </p>

<ul>
<li><strong>정기적으로 <code data-language="powershell">~/.ssh/authorized_keys</code> 파일을 검사</strong>하여 비정상적인 키 추가 여부를 확인합니다.  </li>
<li>중앙 집중형 SSH 키 관리 솔루션을 도입하여 키 사용을 추적하고 관리합니다.  </li>
</ul></li>
<li><p><strong>파일 및 디렉터리 접근 제어 강화</strong>  </p>

<ul>
<li><code data-language="powershell">~/.ssh/authorized_keys</code> 파일의 권한을 <code data-language="powershell">600</code>(소유자만 읽기/쓰기 가능)으로 설정하여 무단 변경을 방지합니다.  </li>
<li><code data-language="powershell">/root/.ssh/</code> 및 중요한 계정의 SSH 디렉터리에 대한 변경 감지 및 경고 시스템을 구축합니다.  </li>
</ul></li>
<li><p><strong>SSH 로그인 정책 강화</strong>  </p>

<ul>
<li><strong>SSH 키 기반 인증 제한</strong>: 관리 계정이나 민감한 서버에서는 SSH 키 인증을 제한하고 다중 인증(MFA)을 적용합니다.  </li>
<li><code data-language="powershell">sshd_config</code>에서 <strong>허용된 SSH 키 목록을 제한</strong> (<code data-language="powershell">AuthorizedKeysFile</code> 설정 조정)합니다.  </li>
</ul></li>
<li><p><strong>로그 및 감사 활성화</strong>  </p>

<ul>
<li><code data-language="powershell">/var/log/auth.log</code> 또는 <code data-language="powershell">/var/log/secure</code>(CentOS/RHEL)에서 <strong>SSH 로그인 및 키 변경 이벤트를 모니터링</strong>합니다.  </li>
<li>SIEM(Security Information and Event Management) 솔루션을 활용하여 <strong>비정상적인 SSH 활동을 탐지</strong>합니다.  </li>
</ul></li>
<li><p><strong>침입 탐지 및 자동 대응</strong>  </p>

<ul>
<li>IDS/IPS(침입 탐지 및 방지 시스템)를 통해 <strong>비정상적인 SSH 접근 패턴을 탐지</strong>하고 자동 차단합니다.  </li>
<li>Fail2Ban과 같은 도구를 활용하여 <strong>SSH 공격을 차단</strong>합니다.  </li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1098.004.01</td>
</tr>
</tbody>
</table>

<p>|D3FEND|
|:-----------:|</p>

</body>
</html>
