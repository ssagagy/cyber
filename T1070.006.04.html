<!DOCTYPE html>
<html>
<head>
    <title>T1070.006.04</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1070.006.04 Indicator Removal on Host: Timestomp</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>touch -acmr 명령어는 파일의 타임스탬프를 수정하는데 사용되므로, 이를 탐지하기 위해서는 파일에 대한 비정상적인 타임스탬프 변경과 시스템 명령 실행 로그를 모니터링해야 한다.</p>

<ol>
<li>명령 실행 로그 모니터링 : touch 명령이 실행된 기록을 로그에서 확인할 수 있다. auditd나 Linux Sysmon과 같은 도구를 활용하여 시스템에서 특정 명령어가 실행된 로그를 수집하고 분석한다.</li>
<li>파일 메타데이터 변경 모니터링 : touch -acmr 명령어는 파일의 메타데이터를 변경하므로, inode에서 타임스탬프 변경을 모니터링할 수 있다. 파일 접근 및 수정 시간 등이 비정상적으로 변경되었는지 확인한다.</li>
<li>비정상적인 타임스탬프 패턴 분석 : 파일의 타임스탬프가 조작되면 일반적인 시스템 활동과 비정상적으로 다른 패턴을 보일 수 있다. 예를 들어, 파일이 생성된 후에 바로 수정된 경우 비정상적인 타임스탬프 변화가 발생한다. 이를 탐지할 수 있다.</li>
</ol>

<h3>Detection(EDR)</h3>

<p><img src="캡처.PNG" alt="캡처 (1)" /></p>

<h3>Response</h3>

<ol>
<li>파일 무결성 확인 및 변조 여부 조사 : 타임스탬프가 변경된 파일에 대해 파일 무결성 검사를 실시하여 변조 여부를 확인해야 한다. 파일의 해시 값을 검증하고, 이전 백업 파일과 비교하여 파일이 수정되었는지 조사한다.</li>
<li>공격자의 활동 분석 : touch 명령이 실행된 사용자의 활동을 추적하여, 해당 사용자가 시스템에서 어떤 다른 활동을 했는지 조사해야 한다. 특히, 다른 침해 흔적이나 추가적인 파일 조작이 있었는지 확인한다.</li>
<li>시스템 격리 및 추가 분석 : 타임스탬프가 조작된 파일이 중요한 시스템 파일이거나 민감한 데이터일 경우, 해당 시스템을 네트워크에서 격리하고 추가 조사를 진행한다. 추가적인 침해 여부를 조사하고 포렌식 분석을 통해 침해의 범위를 파악해야 한다.</li>
</ol>

<h3>Mitigations</h3>

<ol>
<li><p><strong>파일 무결성 검사 도구 사용</strong></p>

<ul>
<li>AIDE, Tripwire 등 파일 무결성 검사 도구를 정기적으로 실행하여 시스템 파일 및 중요한 데이터 파일의 타임스탬프와 메타데이터가 조작되었는지 확인한다.</li>
<li>이러한 도구를 사용하면 파일의 무결성을 실시간으로 모니터링할 수 있다.</li>
</ul></li>
<li><p><strong>로그 감사 및 보존 강화</strong></p>

<ul>
<li>시스템 로그, 특히 파일 액세스 및 시스템 명령어 실행 로그의 보존 기간을 늘리고, 정기적으로 로그를 감사해야 한다.</li>
<li>touch -acmr 명령어가 실행된 기록이 있는지 주기적으로 확인하고, 비정상적인 파일 접근 패턴을 모니터링한다.</li>
</ul></li>
<li><p><strong>권한 관리 강화</strong></p>

<ul>
<li>파일에 대한 타임스탬프 변경 권한을 최소화해야 한다.</li>
<li>불필요한 사용자나 프로세스가 타임스탬프를 조작할 수 없도록 시스템 권한을 강화한다.</li>
<li>일반 사용자에게는 시스템 파일에 대한 touch 명령을 실행할 수 있는 권한을 부여하지 않는다.</li>
</ul></li>
<li><p><strong>파일 및 디렉토리 접근 통제</strong></p>

<ul>
<li>중요한 파일이나 디렉토리에 대한 접근 권한을 최소화하고, 시스템의 중요한 위치에서 비정상적인 파일 변경 활동이 발생하지 않도록 모니터링한다.</li>
<li>특히, root 권한을 가진 사용자의 명령 실행을 제한하는 정책을 시행해야 한다.</li>
</ul></li>
<li><p><strong>SIEM 통합 및 실시간 모니터링</strong></p>

<ul>
<li>보안 정보 및 이벤트 관리(SIEM) 시스템에 로그 데이터를 통합하여 비정상적인 명령 실행이나 파일 조작 활동을 실시간으로 탐지하고 경고할 수 있도록 한다.</li>
<li>SIEM 시스템을 통해 비정상적인 사용자 활동이나 명령어 실행이 탐지되면 즉각적인 알림을 받을 수 있다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1059.004</td>
</tr>
<tr>
  <td style="text-align:center;">T1070.004</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-FIM File Integrity Monitoring</td>
</tr>
</tbody>
</table>

</body>
</html>
