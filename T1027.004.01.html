<!DOCTYPE html>
<html>
<head>
    <title>T1027.004.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1027.004.01 csc.exe 바이너리 파일을 다운로드 C# 코드를 다운로드 받아 csc.exe로 컴파일</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<ol>
<li>Sub_Rule1 :</li>
</ol>

<ul>
<li>CurrentProcess = "powershell.exe" AND</li>
<li>Action = "Network Connect" AND</li>
</ul>

<ol start="2">
<li>Main_rule :</li>
</ol>

<ul>
<li>Check<em>Rule = "Sub</em>Rule1"</li>
<li>CurrentProcess = "powershell.exe" AND</li>
<li>Action = "CreateProcess" AND</li>
<li>TargetCmdLine = "\csc.exe" AND " /out:" AND ".cs"</li>
</ul>

<h3>Detection(EDR)</h3>

<p><img src="EDR사진.png" alt="EDR사진" /></p>

<h3>Response</h3>

<ul>
<li>공격자가 생성한 파일을 삭제합니다.</li>
<li>공격자에 의해 PC가 제어되었을 가능성이 있으므로 호스트 네트워크를 격리합니다.</li>
<li>공격자 C&amp;C 서버로 추정되는 주소를 차단합니다.</li>
</ul>

<h3>Mitigations</h3>

<ol>
<li><strong>애플리케이션 제어(Application Control)</strong> 
<ul>
<li>허용된 스크립트 및 실행 파일만 실행할 수 있도록 제한하여 악성 난독화 스크립트의 실행을 방지합니다.</li>
<li>Windows AppLocker 또는 Software Restriction Policies(SRP) 사용을 고려합니다.</li>
</ul></li>
<li><strong>스크립트 로그 및 모니터링 강화</strong> 
<ul>
<li>PowerShell, JavaScript(JScript), VBScript 등의 스크립트 실행을 로깅하고 비정상적인 실행을 감지합니다.</li>
<li>PowerShell의 Script Block Logging 및 Module Logging을 활성화하여 난독화된 명령을 감시합니다.</li>
</ul></li>
<li><strong>정적 및 동적 분석 도구 활용</strong>  
<ul>
<li>YARA, Sigma 등의 탐지 규칙을 사용하여 난독화된 스크립트 패턴을 탐색합니다.</li>
<li>실행 중인 스크립트의 동작을 분석하여 의심스러운 활동을 식별합니다.</li>
</ul></li>
<li><strong>보안 정책 및 사용자 교육</strong> 
<ul>
<li>직원들에게 난독화된 첨부 파일이나 매크로가 포함된 이메일을 경계하도록 교육합니다.</li>
<li>보안 정책을 통해 승인되지 않은 스크립트 실행을 제한합니다.</li>
</ul></li>
<li><strong>파일 무결성 모니터링</strong> 
<ul>
<li>중요 시스템에서 스크립트 파일 변경을 감지하고, 예상치 못한 변조가 발생하면 경고합니다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1027.004.01</td>
</tr>
</tbody>
</table>

<p>|D3FEND|
|:-----------:|</p>

</body>
</html>
