<!DOCTYPE html>
<html>
<head>
    <title>T1027.010.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1027.010.01 Obfuscated Files or Information: Command Obfuscation</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<ul>
<li>TargetProcess = powershell.exe AND</li>
<li>Action = "CreateProcess"</li>
<li>Targetcmdline = "-encodedcommand" OR "-encodedcomman" OR "-encodedcomma" OR "-encodedcomm" OR "-encodedcom" OR "-encodedco" OR "-encodedc" OR "-encoded" OR "-encode" OR "-encod" OR "-enco" OR "-en" OR "-e"</li>
</ul>

<h3>Detection(EDR)</h3>

<h3>Response</h3>

<p>공격자에 의해 PC가 제어되었을 가능성이 있으므로 호스트 네트워크를 격리합니다.
해당 행위를 수행한 프로세스를 종료합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>악성 코드 탐지 및 분석 강화</strong></p>

<ul>
<li><strong>정적 및 동적 분석 도구 사용</strong>: <strong>Themida</strong>로 패킹된 악성 코드를 분석하기 위해 <strong>정적 분석</strong>(파일을 실행하지 않고 분석)과 <strong>동적 분석</strong>(파일을 실행하여 분석) 도구를 사용합니다. <strong>샌드박스</strong> 환경에서 악성 코드를 실행하여 동작을 추적하고 분석할 수 있습니다.</li>
<li><strong>Themida 패킹 해제 도구 사용</strong>: Themida로 패킹된 악성 코드를 분석하려면 이를 해제할 수 있는 도구를 사용해야 합니다. <strong>Themida 디패킹 도구</strong>나 <strong>PEiD</strong>와 같은 도구를 활용하여 패킹을 해제하고 원본 악성 코드를 복원합니다.</li>
</ul></li>
<li><p><strong>행위 기반 탐지</strong></p>

<ul>
<li><strong>행위 분석</strong>: 패킹된 악성 파일은 초기 실행 시 시스템에서 비정상적인 행동을 보일 수 있습니다. <strong>행위 기반 탐지</strong>를 강화하여, 시스템 호출, <strong>레지스트리 수정</strong>, <strong>네트워크 활동</strong> 등에서 의심스러운 행동을 실시간으로 모니터링하고 탐지합니다.</li>
<li><strong>비정상적인 파일 실행 감지</strong>: <strong>EDR</strong>(Endpoint Detection and Response) 솔루션을 사용하여 의심스러운 파일 실행을 실시간으로 추적하고 차단합니다. 파일 실행 시 발생하는 비정상적인 행동을 기반으로 악성 활동을 식별합니다.</li>
</ul></li>
<li><p><strong>안티 패킹 및 디패킹 기술 사용</strong></p>

<ul>
<li><strong>자동 디패킹 도구</strong>: 보안 소프트웨어에서 <strong>Themida</strong>로 패킹된 악성 파일을 자동으로 디패킹하여 분석할 수 있는 기능을 활성화합니다. 예를 들어, <strong>EDR</strong> 솔루션에서 패킹된 파일을 복원하여 이를 분석하고 대응할 수 있는 기능을 사용합니다.</li>
<li><strong>디패킹 해제 도구 사용</strong>: <strong>Themida</strong>로 패킹된 파일을 해제하기 위해서는 <strong>디패킹 도구</strong>를 사용하여 원본 파일을 복원하고 악성 코드의 동작을 분석합니다. 이를 통해 패킹된 악성 파일을 <strong>정상적인 상태</strong>로 복원할 수 있습니다.</li>
</ul></li>
<li><p><strong>파일 및 메모리 분석 강화</strong></p>

<ul>
<li><strong>메모리 덤프 분석</strong>: 악성 코드가 실행 중일 때 메모리에서 패킹된 상태로 존재할 수 있습니다. <strong>메모리 분석 도구</strong>(예: <strong>Volatility</strong>)를 사용하여 시스템 메모리 덤프에서 <strong>Themida</strong>로 패킹된 악성 코드의 동작을 추적하고 분석합니다.</li>
<li><strong>파일 무결성 검사</strong>: <strong>파일 무결성 모니터링</strong> 도구를 사용하여 파일 시스템에서 <strong>패킹된 파일</strong>이 생성되거나 수정될 때 이를 감지합니다. 또한, <strong>패킹 해제</strong> 후 원본 파일과 해시값을 비교하여 파일의 무결성을 검사합니다.</li>
</ul></li>
<li><p><strong>소프트웨어 보호 및 패킹 도구 제한</strong></p>

<ul>
<li><strong>소프트웨어 보호 도구 차단</strong>: <strong>Themida</strong>와 같은 <strong>소프트웨어 보호</strong> 도구가 시스템에 설치되지 않도록 관리합니다. 시스템의 <strong>관리자 권한</strong>을 제한하고, 이러한 도구가 시스템에 설치되지 않도록 감시합니다.</li>
<li><strong>압축 및 패킹 도구 사용 제어</strong>: <strong>압축 및 패킹 도구</strong>의 실행을 제한하고, <strong>사용자 권한</strong>을 통해 패킹 도구가 설치되지 않도록 차단합니다. 또한, <strong>AppLocker</strong>와 같은 도구를 사용하여 승인되지 않은 프로그램의 실행을 차단합니다.</li>
</ul></li>
<li><p><strong>네트워크 보안 강화</strong></p>

<ul>
<li><strong>네트워크 트래픽 모니터링</strong>: 악성 파일이 네트워크를 통해 전송될 때 암호화된 형태로 전송될 수 있습니다. <strong>Deep Packet Inspection (DPI)</strong>을 통해 <strong>암호화된 트래픽</strong>을 분석하고 <strong>Themida</strong>로 패킹된 악성 파일의 전송을 차단합니다.</li>
<li><strong>보안 게이트웨이 사용</strong>: 네트워크에서 의심스러운 파일을 탐지할 수 있도록 보안 게이트웨이 또는 <strong>웹 필터링</strong> 시스템을 통해 <strong>패킹된 악성 파일</strong>을 필터링하고 차단합니다.</li>
</ul></li>
<li><p><strong>보안 패치 및 취약점 관리</strong></p>

<ul>
<li><strong>소프트웨어 패치 관리</strong>: 시스템의 보안 취약점은 패킹된 악성 코드가 이를 악용할 수 있습니다. <strong>정기적인 보안 패치</strong>와 <strong>업데이트</strong>를 통해 알려진 취약점을 해결하고 패킹된 악성 코드가 침투하는 경로를 차단합니다.</li>
<li><strong>취약점 스캐닝</strong>: 시스템에서 존재하는 보안 취약점을 스캔하고, <strong>패킹된 악성 코드</strong>가 취약점을 악용하지 않도록 보안 패치를 적용합니다.</li>
</ul></li>
<li><p><strong>애플리케이션 제어 및 화이트리스트 사용</strong></p>

<ul>
<li><strong>응용 프로그램 화이트리스트</strong>: <strong>AppLocker</strong> 또는 <strong>Device Guard</strong>와 같은 <strong>애플리케이션 제어</strong> 기능을 활성화하여 허용된 프로그램만 실행되도록 하고, <strong>Themida</strong>로 패킹된 악성 파일을 차단할 수 있습니다.</li>
<li><strong>디지털 서명 검증</strong>: 실행되는 모든 EXE 파일이 <strong>디지털 서명</strong>을 가지고 있는지 검토하여, <strong>서명되지 않은 악성 파일</strong>이 실행되지 않도록 합니다.</li>
</ul></li>
<li><p><strong>사용자 교육 및 인식 제고</strong></p>

<ul>
<li><strong>사회 공학적 공격 방지</strong>: 사용자가 <strong>피싱 이메일</strong>이나 <strong>의심스러운 링크</strong>를 클릭하여 <strong>Themida</strong>로 패킹된 악성 파일을 다운로드하거나 실행하지 않도록 교육합니다.</li>
<li><strong>파일 확장자 및 첨부 파일 인식</strong>: 사용자가 <strong>첨부 파일</strong>을 열기 전에 확장자를 확인하고, 의심스러운 파일을 열지 않도록 훈련시킵니다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1016.000</td>
</tr>
<tr>
  <td style="text-align:center;">T1082.000</td>
</tr>
<tr>
  <td style="text-align:center;">T1119.000</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-FA File Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-DA Dynamic Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-EFA Emulated File Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-FCR File Content Rules</td>
</tr>
<tr>
  <td style="text-align:center;">D3-FH File Hashing</td>
</tr>
</tbody>
</table>

</body>
</html>
