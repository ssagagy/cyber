<!DOCTYPE html>
<html>
<head>
    <title>T1546.013.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1546.013.01 T1546.013.01 - powershell Profile</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>Powershell을 통해 $profile 변수 컨텐츠 추가(Add-Content) 또는 변경(Set-Content)</p>

<h3>Detection(EDR)</h3>

<p><img src="T1546.013.01.png" alt="T1546 013 01" /></p>

<h3>Response</h3>

<ul>
<li>파워쉘 명령 : 파워쉘 명령어 모니터링</li>
<li>프로필 파일 : 프로필 디렉토리 모니터링</li>
<li>파워쉘 프로세스 : 프로필에 의해 실행되는 프로세스 모니터링</li>
</ul>

<h3>Mitigations</h3>

<ol>
<li><p><strong>파일 무결성 검증 (M1033 - Process Monitoring)</strong>  </p>

<ul>
<li><strong>정기적으로 시스템 파일 및 프로세스의 무결성 검증</strong>을 수행하여 <strong>이진 패딩</strong>을 통한 변조를 탐지  </li>
<li><strong>디지털 서명</strong>을 사용하여 <strong>정상적인 파일</strong>만 시스템에서 실행되도록 설정  </li>
<li><strong>파일 무결성 모니터링 도구</strong>를 통해 시스템의 핵심 파일에 대한 변조를 실시간으로 확인  </li>
</ul></li>
<li><p><strong>보안 소프트웨어 및 EDR/XDR 사용 (M1047 - System Logging &amp; Monitoring)</strong>  </p>

<ul>
<li><strong>EDR/XDR 솔루션</strong>을 활용하여 <strong>이진 패딩</strong>으로 변조된 파일을 탐지하고 분석  </li>
<li><strong>의심스러운 파일</strong>이 실행되거나 시스템에 로드될 때 <strong>알림을 설정</strong>하여 실시간으로 대응  </li>
<li><strong>시스템 로그 및 파일 활동</strong>을 추적하여 <strong>패딩된 바이너리</strong>가 실행되는 경로를 분석  </li>
</ul></li>
<li><p><strong>애플리케이션 보안 강화 (M1031 - Network Segmentation)</strong>  </p>

<ul>
<li><strong>정기적인 애플리케이션 보안 검사</strong>를 통해 <strong>악성 파일</strong>이 시스템에서 실행되는 것을 방지  </li>
<li><strong>애플리케이션 패치</strong>를 통해 <strong>이진 패딩 기법을 통한 취약점</strong>을 해결하고, <strong>애플리케이션 보호 기능</strong>을 활성화  </li>
<li><strong>운영 체제의 보안 기능</strong>을 강화하여 악성 코드가 시스템에 침투하지 못하도록 설정  </li>
</ul></li>
<li><p><strong>이상 징후 모니터링 (M1042 - Disable or Remove Feature or Program)</strong>  </p>

<ul>
<li><strong>이상 징후</strong>를 모니터링하여 <strong>파일 크기</strong>나 <strong>메모리 구조</strong>에 변화가 있을 경우 즉시 경고를 받도록 설정  </li>
<li><strong>프로세스 및 메모리 모니터링</strong>을 통해 <strong>비정상적인 이진 파일</strong> 또는 <strong>메모리 변조</strong>가 발생하지 않도록 감시  </li>
<li><strong>시스템의 패딩을 통한 변조</strong>를 방지하기 위해 <strong>파일 크기</strong>와 <strong>데이터 구조</strong>에 대한 규칙을 설정  </li>
</ul></li>
<li><p><strong>정기적인 보안 패치 및 업데이트 (M1022 - Automated Response)</strong>  </p>

<ul>
<li><strong>정기적으로 보안 패치</strong>를 적용하여 <strong>이진 패딩 기법을 통한 공격</strong>에 취약한 지점을 해결  </li>
<li><strong>자동화된 대응 시스템</strong>을 구축하여 악성 코드가 발견되면 즉시 격리 및 삭제되도록 설정  </li>
<li><strong>파일 시스템 및 바이너리 검사 도구</strong>를 사용하여 시스템의 파일 및 실행 중인 프로세스의 정합성을 지속적으로 검증  </li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1546.013</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-SCA System Call Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-FCA File Creation Analysis</td>
</tr>
</tbody>
</table>

</body>
</html>
