<!DOCTYPE html>
<html>
<head>
    <title>T1082.000.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1082.000.01 시스템 정보 수집(Registry)</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>시스템 정보를 획득하기 위한 레지스트리 쿼리 명령어를 실행하는 것을 탐지합니다.</p>

<h3>Detection(EDR)</h3>

<p><img src="T1082.000.01.png" alt="" /></p>

<h3>Response</h3>

<ol>
<li>비정상적인 시스템 명령어 실행 확인: </li>
</ol>

<p>시스템 탐색 명령어(systeminfo, ipconfig, hostname, wmic, uname, ps 등)가 실행된 기록을 확인합니다. 비정상적인 시간대나 일반 사용자가 실행한 경우를 특히 주의 깊게 조사합니다.</p>

<ol start="2">
<li>로그 기록 분석: </li>
</ol>

<p>시스템 로그, 보안 이벤트 로그, PowerShell 로그(Event ID 4104) 등을 분석하여 공격자가 시스템 정보를 수집한 흔적을 찾습니다.</p>

<ol start="3">
<li>악성 프로세스 탐지: </li>
</ol>

<p>시스템 정보 탐색을 수행한 것으로 의심되는 비정상적인 프로세스를 식별합니다. 이를 위해 Task Manager, Process Explorer, ps 등을 사용하여 실행 중인 프로세스를 확인하고 분석합니다.</p>

<ol start="4">
<li>포렌식 도구 사용: </li>
</ol>

<p>Volatility, Sysinternals 등의 도구를 사용하여 메모리 덤프를 분석하고, 시스템 탐색을 시도한 악성 프로세스를 추적합니다.</p>

<ol start="5">
<li>네트워크에서 비정상적인 데이터 전송 탐지: </li>
</ol>

<p>공격자가 수집한 시스템 정보를 외부로 전송하려는 시도를 탐지하기 위해 네트워크 트래픽을 분석합니다. Wireshark, NetFlow 등을 활용하여 비정상적인 패킷이나 데이터 전송이 있는지 확인합니다.</p>

<ol start="6">
<li>C2 서버와의 연결 차단: </li>
</ol>

<p>공격자가 외부 명령 및 제어(C2) 서버로 시스템 정보를 전송하려는 경우 해당 연결을 즉시 차단합니다.</p>

<ol start="7">
<li>의심스러운 시스템 격리: </li>
</ol>

<p>공격이 의심되는 시스템을 네트워크에서 격리하여 추가 피해를 방지하고, 포렌식 분석을 통해 공격자가 어떤 정보를 수집했는지 파악합니다.</p>

<ol start="8">
<li>디스크 및 메모리 포렌식: </li>
</ol>

<p>시스템의 디스크 이미징을 수행하고 메모리 덤프를 분석하여 공격자가 수집한 시스템 정보를 추적합니다.</p>

<ol start="9">
<li>비정상적인 계정 활동 조사: </li>
</ol>

<p>시스템 정보를 수집한 사용자의 계정 활동을 조사하고, 해당 계정이 권한을 남용하여 시스템 정보 탐색을 시도했는지 확인합니다.</p>

<ol start="10">
<li>권한 남용 방지: </li>
</ol>

<p>권한 상승이나 관리자 권한을 부당하게 사용한 계정을 비활성화하거나 재설정하여 추가적인 정보 수집을 방지합니다.</p>

<ol start="11">
<li>침해된 시스템 복구: </li>
</ol>

<p>공격이 의심되는 시스템을 복구하고, 취약점을 해결합니다. 필요한 경우 시스템을 포맷하거나 백업에서 복구하여 악성 활동이 남지 않도록 합니다.</p>

<ol start="12">
<li>보안 정책 재평가 및 업데이트: </li>
</ol>

<p>공격 후 보안 정책을 재검토하고, 추가적인 보안 조치를 시행합니다. 시스템 탐색과 관련된 명령어 실행에 대한 접근 통제를 강화하고, 보안 점검을 정기적으로 수행합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>사용자 권한 제한</strong> </p>

<ul>
<li>시스템 정보 탐색 명령어를 실행할 수 있는 사용자 권한을 제한합니다.</li>
<li>일반 사용자 계정이 관리자 권한을 획득하지 못하도록 권한을 최소화하여, 불필요한 정보 수집을 방지합니다.</li>
</ul></li>
<li><p><strong>특권 계정 관리</strong> </p>

<ul>
<li>관리자 권한이 있는 계정에 대한 접근을 엄격하게 관리하고, 이중 인증(MFA)을 사용하여 추가 보안을 강화합니다.</li>
</ul></li>
<li><p><strong>명령어 실행 제한</strong> </p>

<ul>
<li>systeminfo, hostname, ipconfig, wmic, uname 등과 같은 시스템 정보 수집 명령어의 실행을 제한합니다.</li>
<li>이들 명령어에 대한 실행 권한을 관리자 계정으로 제한합니다.</li>
</ul></li>
<li><p><strong>PowerShell 실행 정책 설정</strong> </p>

<ul>
<li>PowerShell을 통한 시스템 정보 탐색을 제한하기 위해 PowerShell의 실행 정책을 설정하고, 승인된 스크립트만 실행되도록 관리합니다.</li>
</ul></li>
<li><p><strong>시스템 명령어 실행 모니터링</strong> </p>

<ul>
<li>시스템 정보 탐색과 관련된 명령어가 실행되는 로그를 기록하고, 의심스러운 명령어 실행을 모니터링합니다.</li>
<li>PowerShell 및 명령 프롬프트(CMD)에서 실행되는 활동을 집중적으로 모니터링합니다.</li>
</ul></li>
<li><p><strong>SIEM 시스템 설정</strong> </p>

<ul>
<li>SIEM(Security Information and Event Management) 시스템을 활용하여 시스템 정보 수집 명령어의 실행을 탐지하고 경고를 발생시킬 수 있도록 규칙을 설정합니다.</li>
</ul></li>
<li><p><strong>네트워크 분할</strong> </p>

<ul>
<li>공격자가 시스템 탐색을 통해 네트워크 전체를 식별하지 못하도록 네트워크 세그먼트를 분할하여 접근을 제한합니다.</li>
</ul></li>
<li><p><strong>방화벽 및 ACL 설정</strong> </p>

<ul>
<li>공격자가 네트워크에서 시스템 정보를 수집하지 못하도록 방화벽 및 접근 제어 목록(ACL)을 설정하여 중요한 시스템에 대한 접근을 차단합니다.</li>
</ul></li>
<li><p><strong>패치 관리</strong> </p>

<ul>
<li>운영 체제 및 소프트웨어를 최신 보안 패치로 업데이트하여, 시스템 정보 수집과 관련된 취약점을 최소화합니다.</li>
<li>공격자가 알려진 취약점을 통해 시스템 정보를 수집하지 못하도록 합니다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1082.000</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-SCA System Call Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-PM Platform Monitoring</td>
</tr>
<tr>
  <td style="text-align:center;">D3-FA File Analysis</td>
</tr>
</tbody>
</table>

</body>
</html>
