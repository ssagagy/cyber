<!DOCTYPE html>
<html>
<head>
    <title>T1218.011.02</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1218.011.02 시스템 바이너리 프록시 실행, Rundll32</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>rundll32.exe의 "vbscript", "javascript", "mshtml" 커맨드를 탐지한다.</p>

<h3>Detection(EDR)</h3>

<p><img src="T1218.011.02.PNG" alt="T1218 011 02" /></p>

<h3>Response</h3>

<p>regsvr32.exe의 실행 및 매개변수를 모니터링하여 비정상적인 사용을 탐지합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>엑셀 매크로 실행 제한 (M1042 - Disable or Remove Feature or Program)</strong>  </p>

<ul>
<li><strong>엑셀에서 매크로 실행 차단</strong>  
<ul>
<li><strong>그룹 정책</strong>을 통해 매크로 실행을 <strong>"알림" 또는 "모두 차단"</strong>으로 설정  </li>
<li><strong>엑셀 신뢰할 수 있는 위치</strong>에 파일을 두지 않도록 제한  </li>
</ul></li>
<li><strong>보안 경고 활성화</strong>: 매크로가 포함된 파일을 열 때 <strong>보안 경고 창</strong>이 표시되도록 설정  </li>
</ul></li>
<li><p><strong>파일 다운로드 및 실행 제한 (M1031 - Network Segmentation &amp; M1037 - Network Intrusion Prevention)</strong>  </p>

<ul>
<li><strong>이메일 첨부파일에서 엑셀 파일을 열지 않도록 사용자 교육</strong>  </li>
<li><strong>첨부파일 실행을 차단하거나 제한</strong>하는 이메일 보안 솔루션 적용  </li>
<li><strong>악성 링크를 통한 다운로드 차단</strong>: 이메일 및 웹 필터링을 통해 악성 엑셀 파일 다운로드 차단  </li>
</ul></li>
<li><p><strong>엑셀 매크로 및 스크립트 감시 및 탐지 (M1047 - System Logging &amp; Monitoring)</strong>  </p>

<ul>
<li><strong>엑셀 관련 이벤트 모니터링</strong> (엑셀에서 매크로가 실행되었을 때 이벤트 로그 기록)  </li>
<li><strong>EDR/XDR 솔루션을 활용한 악성 엑셀 파일 탐지</strong>  </li>
<li><strong>자동 실행된 매크로 탐지 및 차단</strong>  </li>
</ul></li>
<li><p><strong>PowerShell 및 VBA 스크립트 제한 (M1026 - Privileged Account Management)</strong>  </p>

<ul>
<li><strong>PowerShell 및 VBA 스크립트 제한</strong>: 그룹 정책을 통해 PowerShell 또는 VBA 스크립트 실행 제한  </li>
<li><strong>사용자 권한 최소화</strong>: 일반 사용자에게 엑셀 매크로 실행 및 PowerShell 실행 권한을 제한  </li>
</ul></li>
<li><p><strong>사용자 교육 및 보안 인식 강화 (M1019 - Awareness and Training)</strong>  </p>

<ul>
<li><strong>첨부된 엑셀 파일을 열지 않도록 사용자 교육</strong>  </li>
<li><strong>매크로와 관련된 보안 위험을 사용자에게 인식시키는 교육</strong>  </li>
<li><strong>신뢰할 수 없는 소스의 파일 열지 않기</strong>  </li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1497.001</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-PM Platform Monitoring</td>
</tr>
<tr>
  <td style="text-align:center;">D3-PLA Process Lineage Analysis</td>
</tr>
</tbody>
</table>

</body>
</html>
