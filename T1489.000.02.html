<!DOCTYPE html>
<html>
<head>
    <title>T1489.000.02</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1489.000.02 식별된 보안 프로그램 서비스 중지</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>powershell.exe가 wmi를 통해 자사 제품의 서비스를 조회 후 종료하는 명령을 탐지합니다.</p>

<h3>Detection(EDR)</h3>

<p><img src="T1489.000.02.png" alt="" /></p>

<h3>Response</h3>

<ol>
<li>Windows 이벤트 로그 모니터링:</li>
</ol>

<p>sc.exe 또는 PowerShell을 사용하여 서비스 중단을 시도하는 명령을 모니터링합니다.</p>

<ol start="2">
<li>SIEM을 통한 이상 탐지:</li>
</ol>

<p>Splunk, Microsoft Sentinel, 또는 ELK 스택에서 서비스 중단 관련 로그를 수집하고 탐지 규칙을 생성합니다.</p>

<ol start="3">
<li>Sysmon을 활용한 상세 모니터링:</li>
</ol>

<p>Sysmon으로 프로세스 생성 및 서비스 관리 활동을 기록합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>서비스 비활성화 방지</strong></p>

<ul>
<li>중요한 서비스에 대해 중단 또는 변경 권한을 제한하거나 중요한 서비스가 비활성화되지 않도록 그룹 정책을 설정합니다.</li>
</ul></li>
<li><p><strong>서비스 복구 설정 강화</strong></p>

<ul>
<li>서비스가 중단될 경우 자동으로 재시작되도록 복구 설정을 구성합니다.</li>
</ul></li>
<li><p><strong>AppLocker 및 WDAC 정책 적용</strong></p>

<ul>
<li>보안 솔루션이나 서비스 관리 도구(sc.exe, powershell.exe, taskkill.exe)의 실행을 제한합니다.</li>
</ul></li>
<li><p><strong>관리자 계정 최소화</strong></p>

<ul>
<li>로컬 관리자 계정에 대한 접근을 제한하고, 관리 작업을 최소화합니다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1007.000</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-PT Process Termination</td>
</tr>
<tr>
  <td style="text-align:center;">D3-PS Process Suspension</td>
</tr>
<tr>
  <td style="text-align:center;">D3-SBV Service Binary Verification</td>
</tr>
<tr>
  <td style="text-align:center;">D3-SCF System Call Filtering</td>
</tr>
<tr>
  <td style="text-align:center;">D3-ED Executable Denylisting</td>
</tr>
<tr>
  <td style="text-align:center;">D3-EWSAM Endpoint-based Web Server Access Mediation</td>
</tr>
</tbody>
</table>

</body>
</html>
