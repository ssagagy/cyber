<!DOCTYPE html>
<html>
<head>
    <title>T1135.000.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1135.000.01 네트워크 공유 정보 수집</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<ul>
<li>행동 유형 : AMSI_SCAN</li>
<li>오퍼레이션 : contains</li>
<li>값1 : Get-PSDrive</li>
<li>값2 : -Name *</li>
</ul>

<h3>Detection(EDR)</h3>

<p><img src="T1135.000.01.png" alt="" /></p>

<p>https://172.18.10.125:8903/#/analysis/incident/67a99f3d002dc6ce00000381</p>

<h3>Response</h3>

<ol>
<li>네트워크 및 시스템 로그 모니터링</li>
</ol>

<ul>
<li><p>이상한 네트워크 공유 탐색 시도 감지 (Windows Event ID 5140 - 네트워크 공유 객체에 대한 접근 이벤트)</p></li>
<li><p>Linux 환경에서는 /var/log/samba/ 또는 /var/log/messages에서 SMB 및 NFS 접근 로그 분석</p></li>
<li><p>SIEM 솔루션을 활용하여 비정상적인 공유 폴더 탐색 활동 감시</p></li>
</ul>

<ol start="2">
<li>침해 지표(IOC) 분석 및 탐지</li>
</ol>

<ul>
<li><p>공격자가 주로 사용하는 명령어 (net view, Get-SmbShare, smbclient -L, showmount -e) 실행 로그 수집 및 분석</p></li>
<li><p>네트워크 트래픽에서 비정상적인 SMB, NFS 요청 탐지 (예: 과도한 연결 요청)</p></li>
<li><p>EDR/XDR을 활용하여 악성 스크립트 및 자동화된 네트워크 탐색 활동 탐지</p></li>
</ul>

<ol start="3">
<li>침해 사고 대응 (Incident Response)</li>
</ol>

<ul>
<li><p>의심스러운 네트워크 공유 접근 탐지 시 즉시 차단 및 계정 비활성화</p></li>
<li><p>네트워크 공유 폴더의 접근 권한 검토 후 불필요한 공유 해제</p></li>
<li><p>침해된 시스템에 대한 포렌식 분석 수행하여 추가 공격 여부 확인</p></li>
<li><p>공격자가 획득한 정보가 있는지, 추가 lateral movement가 발생했는지 분석</p></li>
</ul>

<h3>Mitigations</h3>

<ol>
<li>최소 권한 원칙 적용 (Least Privilege Enforcement)</li>
</ol>

<ul>
<li><p>네트워크 공유 폴더 접근을 필요 최소 권한 원칙(Least Privilege Principle)으로 제한</p></li>
<li><p>"Everyone" 또는 "Authenticated Users" 그룹에 대한 공유 폴더 접근 권한 제거</p></li>
<li><p>NTFS 권한을 활용하여 민감한 데이터 접근을 관리자 및 특정 사용자 그룹으로 제한</p></li>
</ul>

<ol start="2">
<li>공유 폴더 및 네트워크 접근 제한</li>
</ol>

<ul>
<li><p>불필요한 네트워크 공유 폴더 및 SMB 서비스 비활성화</p></li>
<li><p>공유 폴더 및 파일 서버 접근 시 VPN 또는 특정 IP에서만 허용</p></li>
<li><p>Windows 방화벽 및 그룹 정책(GPO) 설정을 통해 외부에서의 네트워크 공유 접근 차단</p></li>
</ul>

<ol start="3">
<li>네트워크 보안 강화</li>
</ol>

<ul>
<li><p>SMBv1 비활성화 (Set-SmbServerConfiguration -EnableSMB1Protocol $false)</p></li>
<li><p>방화벽을 통해 SMB (TCP 445), NFS (TCP 2049) 및 기타 네트워크 공유 프로토콜 제한</p></li>
<li><p>"NetBIOS over TCP/IP" 및 LLMNR(Link-Local Multicast Name Resolution) 비활성화하여 네트워크 공유 조회 차단</p></li>
</ul>

<ol start="4">
<li>사용자 보안 인식 교육 및 정책 강화</li>
</ol>

<ul>
<li><p>네트워크 공유 드라이브에 저장된 파일의 보안 정책을 주기적으로 점검</p></li>
<li><p>중요한 데이터는 암호화하여 저장하고, 필요 시 DLP(Data Loss Prevention) 솔루션 적용</p></li>
<li><p>정기적인 보안 감사(Security Audit)를 통해 권한이 과도하게 부여된 공유 폴더 검토</p></li>
</ul>

<h2>Affected Techniques</h2>

<p>Action 실행시 함께 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">Techniques</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1135</td>
</tr>
</tbody>
</table>

</body>
</html>
