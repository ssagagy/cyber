<!DOCTYPE html>
<html>
<head>
    <title>T1007.000.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1007.000.01 시스템 서비스 식별</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>Action = "ProcessCreate" AND
TargetProcess = "sc.exe" AND
Cmdline = "sc query" AND
Cmdline != "findstr atxufpk"</p>

<h3>Detection(EDR)</h3>

<p><img src="T1007.000.01.png" alt="T1007_000_01" />
https://172.18.10.125:8903/#/analysis/alert/66f10e99002dc79400000001</p>

<h3>Response</h3>

<p>해당 행위를 수행한 프로세스를 종료합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>서비스 목록 접근 제한</strong>  </p>

<ul>
<li><strong>권한 최소화</strong>: 서비스 목록을 열람할 수 있는 권한을 제한합니다. 일반 사용자 및 낮은 권한의 계정은 서비스 목록을 확인할 수 없도록 설정합니다.  </li>
<li><strong>로컬 그룹 및 관리 권한 제어</strong>: 서비스 탐지를 위한 권한이 필요한 경우 <strong>로컬 관리자 그룹</strong>에 대한 접근을 제한하고, <strong>서비스 계정</strong>을 최소화합니다.  </li>
</ul></li>
<li><p><strong>보안 솔루션 강화</strong>  </p>

<ul>
<li><strong>EDR/XDR 솔루션</strong>을 사용하여 서비스 정보 조회 시 비정상적인 행동을 탐지합니다. 예를 들어, <code data-language="powershell">sc query</code>, <code data-language="powershell">tasklist</code>, <code data-language="powershell"><span class="keyword">Get-Service</span></code> 등의 명령어가 실행될 때 경고를 생성하고, 의심스러운 서비스나 프로세스를 분석합니다.  </li>
<li><strong>Windows Defender</strong> 및 타 보안 소프트웨어에서 서비스 정보의 비정상적인 접근을 차단하거나 탐지합니다.  </li>
</ul></li>
<li><p><strong>이벤트 로깅 및 감사 정책 강화</strong>  </p>

<ul>
<li><strong>Windows Event Log</strong>에서 서비스 변경 및 관련 이벤트(<code data-language="powershell">7045</code>, <code data-language="powershell">7040</code>, <code data-language="powershell">4688</code>)를 모니터링하여 서비스가 비정상적으로 추가되거나 수정된 경우 이를 추적합니다.  </li>
<li><strong>Audit Policy</strong>를 통해 시스템에 대한 서비스 변경 및 조회 로그를 활성화하여, 비정상적인 서비스 목록 조회를 탐지할 수 있습니다.  </li>
</ul></li>
<li><p><strong>서비스 및 프로세스 모니터링</strong>  </p>

<ul>
<li>서비스 목록 조회를 포함한 <strong>프로세스 및 서비스 변경 모니터링</strong>을 활성화하여 시스템에 의도하지 않은 서비스가 추가되었을 때 실시간으로 경고를 받습니다.  </li>
<li><strong>Sysmon</strong>을 사용하여 <code data-language="powershell">Event ID 10</code> (Process Access) 등을 모니터링하여 서비스 관련 변화를 감지합니다.  </li>
</ul></li>
<li><p><strong>네트워크 보안 및 제한</strong>  </p>

<ul>
<li><strong>RDP (원격 데스크탑 프로토콜)</strong> 및 원격 서비스에 대한 접근을 제한하고, <strong>MFA (다단계 인증)</strong>를 적용하여 서비스에 대한 원격 접근을 어렵게 만듭니다.  </li>
<li><strong>서비스 권한에 대한 접근을 제한</strong>하고, <strong>최소 권한 원칙</strong>을 적용하여 공격자가 서비스 정보를 얻기 위해 시스템에 접근하는 것을 방지합니다.  </li>
</ul></li>
<li><p><strong>정기적인 보안 점검 및 패치 적용</strong>  </p>

<ul>
<li>시스템의 서비스 목록 및 구성을 정기적으로 점검하여, 불필요한 서비스가 실행 중인지 확인하고 제거합니다.  </li>
<li><strong>최신 보안 패치</strong>를 적용하여 서비스 관련 취약점이 악용되지 않도록 방지합니다.  </li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1007.000</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-SICA System Init Config Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-PM Platform Monitoring</td>
</tr>
<tr>
  <td style="text-align:center;">D3-FA File Analysis</td>
</tr>
</tbody>
</table>

</body>
</html>
