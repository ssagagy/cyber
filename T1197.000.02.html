<!DOCTYPE html>
<html>
<head>
    <title>T1197.000.02</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1197.000.02 BITS Jobs</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>Bitsadmin 프로세스의 명령줄을 확인하여 악성 여부를 판단하여 탐지합니다. </p>

<h3>Detection(EDR)</h3>

<p><img src="T1197.000.02.png" alt="" />
https://172.18.10.125:8903/#/analysis/alert/66f110ee002dc79400000016</p>

<h3>Response</h3>

<p>해당 행위를 수행한 프로세스를 종료합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>BITS 서비스 남용 제한 (M1042 - Disable or Remove Feature or Program)</strong>  </p>

<ul>
<li><strong>BITS 서비스 비활성화</strong> (필요하지 않은 환경)  
<ul>
<li><code data-language="powershell">sc config BITS start= disabled</code>  </li>
</ul></li>
<li><strong>BITSAdmin 비활성화</strong> 또는 <strong>BITS 관련 PowerShell 명령어 사용 제한</strong>  
<ul>
<li>AppLocker 또는 WDAC(Windows Defender Application Control) 적용  </li>
</ul></li>
</ul></li>
<li><p><strong>BITS 작업 생성 및 실행 모니터링 (M1047 - System Logging &amp; Monitoring)</strong>  </p>

<ul>
<li>Windows 이벤트 로그에서 <strong>BITS 관련 이벤트 감시</strong>  
<ul>
<li><strong>Event ID 16384</strong> (새로운 BITS 작업 생성)  </li>
<li><strong>Event ID 16385</strong> (BITS 작업 완료)  </li>
</ul></li>
<li><strong>Sysmon Rule 설정</strong>: BITSAdmin 또는 PowerShell을 사용한 의심스러운 활동 모니터링  </li>
</ul></li>
<li><p><strong>비정상적인 네트워크 활동 탐지 (M1037 - Network Intrusion Prevention)</strong>  </p>

<ul>
<li><strong>BITS를 통한 네트워크 연결 모니터링</strong> (비인가된 외부 서버와의 연결 탐지)  </li>
<li><strong>EDR/XDR 솔루션 활용</strong>하여 의심스러운 BITS 작업 실행 탐지  </li>
</ul></li>
<li><p><strong>최소 권한 원칙 적용 (M1026 - Privileged Account Management)</strong>  </p>

<ul>
<li>BITS 작업을 생성할 수 있는 <strong>사용자 권한 제한</strong>  </li>
<li><code data-language="powershell">SeImpersonatePrivilege</code> 권한 제거를 통해 공격자가 SYSTEM 권한으로 BITS 작업을 실행하지 못하도록 차단  </li>
</ul></li>
<li><p><strong>보안 정책 및 사용자 교육 (M1019 - Awareness and Training)</strong>  </p>

<ul>
<li><strong>BITS 악용 사례 교육 및 보안 인식 강화</strong>  </li>
<li><strong>비정상적인 파일 다운로드 및 실행 감지 방법 훈련</strong><br />
<h2>Affected Techniques</h2></li>
</ul></li>
</ol>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1059.001</td>
</tr>
<tr>
  <td style="text-align:center;">T1105.000</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-NTA Network Traffic Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-NTF Network Traffic Filtering</td>
</tr>
<tr>
  <td style="text-align:center;">D3-ETW Event Tracing for Windows</td>
</tr>
<tr>
  <td style="text-align:center;">D3-PM Platform Monitoring</td>
</tr>
</tbody>
</table>

</body>
</html>
