<!DOCTYPE html>
<html>
<head>
    <title>T1021.003.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1021.003.01 Remote Services: Distributed Component Object Model</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>Action = "ProcessCreate" AND 
CurrentProcess = "powershell.exe" AND 
TargetProcess = "net.exe" AND 
Cmdline = "use"</p>

<h3>Detection(EDR)</h3>

<p><img src="T1021.003.01.png" alt="T1021 003 01" /></p>

<h3>Response</h3>

<p>원격 접속 로그를 모니터링하고 비정상적인 원격 연결 시도를 즉시 조사하여 대응합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>파일 전송 서비스 제한</strong></p>

<ul>
<li><strong>파일 공유 비활성화</strong>: 원격 파일 복사를 위한 서비스(예: <strong>SMB</strong>, <strong>FTP</strong>, <strong>NFS</strong>)를 비활성화하거나, 사용되지 않는 프로토콜을 차단하여 공격자가 이를 통해 파일을 복사할 수 없도록 합니다.</li>
<li><strong>RDP 및 SMB 포트 차단</strong>: <strong>RDP</strong>와 <strong>SMB</strong>와 같은 파일 전송에 사용되는 포트(기본적으로 <strong>TCP 3389</strong> 및 <strong>TCP 445</strong>)를 외부 네트워크에서 접근할 수 없도록 <strong>방화벽</strong>을 설정합니다.</li>
</ul></li>
<li><p><strong>파일 전송 암호화 및 인증 강화</strong></p>

<ul>
<li><strong>파일 전송 암호화</strong>: 원격 파일 복사가 발생할 때 <strong>암호화된 프로토콜</strong>(예: <strong>SFTP</strong> 또는 <strong>FTPS</strong>)을 사용하여, 전송 중인 데이터가 탈취되지 않도록 보호합니다.</li>
<li><strong>강력한 인증 사용</strong>: 파일 전송 서비스에는 <strong>다단계 인증(MFA)</strong>을 사용하여 파일 복사 작업이 불법적으로 수행되지 않도록 보안 계층을 추가합니다.</li>
</ul></li>
<li><p><strong>파일 공유 권한 제한</strong></p>

<ul>
<li><strong>파일 공유 권한 최소화</strong>: SMB, NFS, FTP와 같은 파일 공유 서비스를 사용할 때, <strong>읽기/쓰기 권한</strong>을 최소화하여 <strong>불필요한 공유</strong>를 차단합니다. 공격자가 복사하려는 파일에 대한 접근을 어렵게 만듭니다.</li>
<li><strong>파일 시스템 권한 관리</strong>: <strong>NTFS</strong>(Windows) 또는 <strong>ext4</strong>(Linux)와 같은 파일 시스템의 <strong>권한 설정</strong>을 통해, 민감한 파일에 대한 접근을 제한합니다.</li>
</ul></li>
<li><p><strong>보안 프로토콜 및 접근 제어</strong></p>

<ul>
<li><strong>보안 파일 공유 프로토콜 사용</strong>: <strong>SMBv1</strong>을 비활성화하고, <strong>SMBv2</strong> 또는 <strong>SMBv3</strong>와 같은 더 안전한 파일 공유 프로토콜을 사용합니다. SMBv1은 여러 보안 취약점이 있어 공격자가 악용할 수 있습니다.</li>
<li><strong>VPN 및 SSH 사용</strong>: 원격 파일 복사를 허용해야 할 경우, <strong>VPN</strong> 또는 <strong>SSH</strong>(Secure Shell)를 사용하여 보안된 통신 경로를 통해 파일을 전송합니다. 이를 통해 원격 서버와의 연결을 암호화하여 안전하게 파일을 복사할 수 있습니다.</li>
</ul></li>
<li><p><strong>파일 무결성 검사</strong></p>

<ul>
<li><strong>파일 무결성 검사</strong>: 파일 전송 시, <strong>해시 값</strong>(예: MD5, SHA-256) 비교를 통해 파일이 손상되지 않고 안전하게 전송되었는지 확인합니다.</li>
<li><strong>무결성 검증 시스템</strong>: <strong>HIDS</strong>(Host-based Intrusion Detection System) 또는 <strong>EDR</strong>(Endpoint Detection and Response) 솔루션을 사용하여 파일 복사 활동을 모니터링하고, 비정상적인 활동을 탐지합니다.</li>
</ul></li>
<li><p><strong>네트워크 세분화 및 접근 제어</strong></p>

<ul>
<li><strong>네트워크 세분화</strong>: 원격 시스템 간의 파일 전송을 제한하려면 <strong>네트워크를 세분화</strong>하고, 중요 시스템을 별도의 VLAN 또는 <strong>서브넷</strong>에 배치하여 원격 파일 복사를 통한 접근을 방지합니다.</li>
<li><strong>파일 전송에 대한 IP 접근 제어</strong>: <strong>IP 화이트리스트</strong> 또는 <strong>ACL(액세스 제어 목록)</strong>을 사용하여 신뢰된 IP 주소만 파일 전송 서비스에 접근할 수 있도록 제한합니다.</li>
</ul></li>
<li><p><strong>로그 분석 및 모니터링</strong></p>

<ul>
<li><strong>원격 파일 복사 로그 모니터링</strong>: <strong>Windows Event Logs</strong>, <strong>Sysmon</strong> 및 <strong>Linux Syslog</strong>를 사용하여 원격 파일 복사 작업을 감시하고 의심스러운 활동을 기록합니다.</li>
<li><strong>실시간 모니터링</strong>: <strong>SIEM</strong>(Security Information and Event Management) 시스템을 통해 원격 파일 전송 관련 로그를 실시간으로 모니터링하고, 이상 징후를 감지하여 알림을 받을 수 있습니다.</li>
</ul></li>
<li><p><strong>보안 패치 및 취약점 관리</strong></p>

<ul>
<li><strong>정기적인 보안 패치 적용</strong>: <strong>파일 전송 서비스</strong>와 관련된 취약점을 방지하기 위해 <strong>Windows</strong>와 <strong>Linux</strong> 시스템에 대한 보안 패치를 주기적으로 적용합니다.</li>
<li><strong>취약점 스캔</strong>: 파일 전송 서비스를 제공하는 시스템에 대해 <strong>취약점 스캐닝</strong> 도구를 사용하여 알려진 취약점에 대한 점검을 수행하고, 이를 기반으로 패치를 적용합니다.</li>
</ul></li>
<li><p><strong>권한 있는 사용자 및 계정 관리</strong></p>

<ul>
<li><strong>특권 계정 관리</strong>: 파일 전송 작업을 수행하는 사용자 계정에 대해 최소 권한 원칙을 적용하고, <strong>관리자 권한</strong>을 부여하지 않습니다. 이를 통해 공격자가 관리자 권한을 가진 계정을 악용할 가능성을 줄입니다.</li>
<li><strong>계정 잠금 정책</strong>: <strong>계정 잠금 정책</strong>을 설정하여 비정상적인 로그인 시도가 발생할 경우 계정을 잠금으로써 원격 파일 복사 시도가 악용되지 않도록 합니다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1059.001</td>
</tr>
<tr>
  <td style="text-align:center;">T1049.000</td>
</tr>
<tr>
  <td style="text-align:center;">T1135.000</td>
</tr>
<tr>
  <td style="text-align:center;">T1070.005</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-NTA Network Traffic Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-NTF Network Traffic Filtering</td>
</tr>
<tr>
  <td style="text-align:center;">D3-ITF Inbound Traffic Filtering</td>
</tr>
<tr>
  <td style="text-align:center;">D3-OTF Outbound Traffic Filtering</td>
</tr>
</tbody>
</table>

</body>
</html>
