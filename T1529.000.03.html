<!DOCTYPE html>
<html>
<head>
    <title>T1529.000.03</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1529.000.03 System Shutdown</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>명령어(shutdown)를 이용하여 시스템을 종료하는 행위를 탐지합니다.</p>

<h3>Detection(EDR)</h3>

<p><img src="T1529.000.03.png" alt="" /></p>

<h3>Response</h3>

<ol>
<li>재부팅 또는 종료 기록 분석: </li>
</ol>

<p>journalctl 명령어를 사용해 시스템 재부팅 또는 종료 관련 로그를 분석합니다. /var/log/messages 또는 /var/log/syslog 파일을 통해 시스템 재부팅이나 종료와 관련된 이벤트를 추적합니다.</p>

<ol start="2">
<li>비정상적인 재부팅 시도 확인: </li>
</ol>

<p>종료 또는 재부팅이 루트 권한에 의해 정상적으로 이루어진 것인지, 또는 비정상적인 방법으로 시도된 것인지 확인합니다. last 명령어를 통해 시스템 종료 또는 재부팅 시간을 확인할 수 있습니다.</p>

<ol start="3">
<li>관련 프로세스 탐지: </li>
</ol>

<p>재부팅 또는 종료 시도를 한 프로세스와 명령어(shutdown, reboot, halt)를 추적합니다. ps, pstree, top 등의 도구를 사용해 종료 또는 재부팅을 시도한 프로세스를 분석합니다.</p>

<ol start="4">
<li>사용자 계정 조사: </li>
</ol>

<p>시스템 종료나 재부팅을 시도한 사용자 계정을 분석하고, 해당 계정이 악의적인 목적으로 사용되었는지 여부를 조사합니다. who, w, last 명령어를 통해 접속 사용자와 세션 정보를 파악합니다.</p>

<ol start="5">
<li>중앙 로그 서버에서 복구: </li>
</ol>

<p>재부팅이나 종료 전에 중앙화된 로그 서버로 전송된 로그 데이터를 복구하여 공격자가 시스템을 종료하기 전에 수행한 활동을 추적합니다.</p>

<ol start="6">
<li>포렌식 도구 사용: </li>
</ol>

<p>디스크 및 메모리 포렌식 도구를 사용해 시스템 종료 이전의 상태를 복구하고, 종료 전에 실행된 악성 명령이나 프로세스를 분석합니다.</p>

<ol start="7">
<li>네트워크 트래픽 모니터링: </li>
</ol>

<p>시스템 종료 또는 재부팅 시점 전후로 발생한 네트워크 활동을 분석하여 외부 서버와의 통신이 있었는지 확인합니다. Wireshark, TCPDump 등의 네트워크 분석 도구를 사용하여 악의적인 활동을 탐지합니다.</p>

<ol start="8">
<li>추가 악성 활동 탐지: </li>
</ol>

<p>재부팅 후에도 남아 있는 파일 및 네트워크 활동을 분석하여 공격자가 다른 악성 활동을 수행했는지 여부를 조사합니다.</p>

<ol start="9">
<li>보안 정책 업데이트: </li>
</ol>

<p>시스템 종료 및 재부팅 시도가 발생한 후, 관련 보안 정책을 재평가하고 강화합니다. 권한 관리, 로그 보호 및 무결성 검사 절차를 강화하여 추가적인 공격을 방지합니다.</p>

<ol start="10">
<li>시스템 복구: </li>
</ol>

<p>공격자가 시스템을 종료 또는 재부팅하여 공격을 은폐하려는 경우, 침해된 시스템을 복구하고, 필요하다면 초기화 또는 백업에서 시스템을 복구합니다.</p>

<ol start="11">
<li>포렌식 증거 수집: </li>
</ol>

<p>시스템 종료 및 재부팅과 관련된 모든 활동을 문서화하고, 법적 대응에 필요한 증거를 수집합니다. 재부팅 시도와 관련된 프로세스, 사용자, IP 주소 등의 정보를 기록하여 법 집행 기관에 보고할 수 있습니다.</p>

<ol start="12">
<li>시스템 재설정: </li>
</ol>

<p>악의적인 종료나 재부팅이 감지된 경우, 시스템을 초기화하고, 필요한 데이터를 백업 및 복구한 후, 시스템을 정상 상태로 되돌립니다.</p>

<ol start="13">
<li>보안 절차 검토: </li>
</ol>

<p>재부팅 시도 후 시스템의 보안 설정과 절차를 검토하고, 필요한 경우 업데이트하여 이후 유사한 공격 시도를 방지합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>시스템 종료 권한 제한 (M1026 - Privileged Account Management)</strong>  </p>

<ul>
<li><strong>시스템 종료 권한을 제한</strong>하고, <strong>일반 사용자</strong>에게 시스템 종료 권한을 부여하지 않음  </li>
<li><strong>시스템 종료 및 재부팅</strong>을 위한 권한을 <strong>최소화</strong>하여 관리자의 허가 없이 시스템이 종료되지 않도록 설정  </li>
<li><strong>관리자 계정에 대해 다단계 인증(MFA)</strong>을 적용하여 권한 상승 후 시스템 종료를 방지  </li>
</ul></li>
<li><p><strong>시스템 종료 모니터링 및 알림 설정 (M1047 - System Logging &amp; Monitoring)</strong>  </p>

<ul>
<li><strong>시스템 종료 및 재부팅 이벤트</strong>를 실시간으로 모니터링하고 알림을 받도록 설정 (예: Event ID 1074)  </li>
<li><strong>로그 파일</strong>을 설정하여 <strong>시스템 종료 및 종료 요청</strong>에 대한 정보를 기록하고, 의심스러운 종료 이벤트 발생 시 즉시 알림  </li>
<li><strong>EDR/XDR</strong> 솔루션을 사용하여 <strong>시스템 종료 이벤트</strong>를 실시간으로 추적하고 대응  </li>
</ul></li>
<li><p><strong>자동 복구 및 시스템 백업 (M1022 - Automated Response)</strong>  </p>

<ul>
<li><strong>시스템 종료 후 자동 복구</strong>: 중요한 시스템에 대해서는 시스템 종료 후 자동으로 서비스를 재시작하거나 복구되는 기능을 활성화  </li>
<li><strong>중요 데이터 및 시스템에 대한 정기적인 백업</strong>을 통해 시스템 종료 후 데이터 손실을 방지  </li>
<li><strong>자동 복구 스크립트</strong>를 작성하여 시스템 종료 후 자동으로 원래 상태로 복원될 수 있도록 설정  </li>
</ul></li>
<li><p><strong>시스템 세분화 및 방화벽 규칙 (M1031 - Network Segmentation)</strong>  </p>

<ul>
<li><strong>네트워크 세분화</strong>를 통해 중요 시스템에 대한 접근을 제한하고, 시스템 종료가 발생했을 때 영향을 최소화  </li>
<li><strong>방화벽 및 접근 제어 목록(ACL)</strong>을 사용하여 특정 사용자만 시스템에 접근하고 종료할 수 있도록 제한  </li>
<li><strong>시스템 종료</strong>가 중요한 서비스에 미치는 영향을 최소화하기 위해 <strong>방화벽 규칙</strong>을 설정하여 외부로부터의 불법적인 종료 시도를 차단  </li>
</ul></li>
<li><p><strong>시스템 종료 기능 잠금 (M1042 - Disable or Remove Feature or Program)</strong>  </p>

<ul>
<li><strong>시스템 종료 기능을 잠그거나 제한</strong>하여, 공격자가 쉽게 시스템을 종료하지 못하도록 설정  </li>
<li><strong>정기적으로 운영 체제 및 보안 패치</strong>를 적용하여 <strong>시스템 종료</strong>를 유발할 수 있는 취약점이 존재하지 않도록 유지  </li>
<li><strong>물리적 보안</strong>을 강화하여, 악의적인 사용자가 직접 시스템 종료를 시도하는 경우에도 제어할 수 있도록 설정  </li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1059.004</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-NTF Network Traffic Filtering</td>
</tr>
<tr>
  <td style="text-align:center;">D3-NTA Network Traffic Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-SU Software Update</td>
</tr>
</tbody>
</table>

</body>
</html>
