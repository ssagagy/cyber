<!DOCTYPE html>
<html>
<head>
    <title>T1071.001.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1071.001.01 애플리케이션 계층 프로토콜: 웹 프로토콜</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>80번 포트를 이용해 특정 IP에 연결하는 행위를 탐지한다.</p>

<h3>Detection(EDR)</h3>

<p><img src="T1071.001.01.png" alt="T1071 001 01" /></p>

<h3>Response</h3>

<p>공격자가 웹 프로토콜을 사용하여 명령 및 제어(C2) 서버와 통신하는 경우, 즉시 해당 C2 서버와의 통신을 차단하고, 해당 IP 주소 또는 도메인을 블랙리스트에 추가합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>네트워크 트래픽 분석 및 필터링 (M1032 - Network Traffic Filtering)</strong></p>

<ul>
<li><strong>웹 트래픽</strong>을 포함한 <strong>네트워크 트래픽</strong>을 <strong>심층 분석</strong>하여 <strong>HTTP/HTTPS</strong> 요청을 모니터링하고 <strong>비정상적인 요청 패턴</strong>을 탐지  </li>
<li><strong>웹 애플리케이션 방화벽(WAF)</strong>을 활용하여 <strong>HTTP/HTTPS 요청</strong>을 필터링하고 <strong>비정상적인 트래픽</strong>이나 <strong>C2 통신</strong>을 차단  </li>
<li><strong>Anomaly Detection</strong> 도구를 사용하여 <strong>웹 프로토콜</strong>을 통한 <strong>비정상적인 트래픽 패턴</strong>을 탐지하고 차단</li>
</ul></li>
<li><p><strong>웹 애플리케이션 보안 강화 (M1042 - Web Application Firewall (WAF))</strong></p>

<ul>
<li><strong>웹 애플리케이션 방화벽(WAF)</strong>을 설치하여 <strong>HTTP/HTTPS</strong> 기반의 악성 요청을 차단하고, <strong>명령어 삽입</strong>이나 <strong>비정상적인 패턴</strong>을 탐지  </li>
<li><strong>HTTPS 트래픽 검사</strong>를 활성화하여 <strong>SSL/TLS 암호화</strong>된 웹 프로토콜에서도 <strong>C2 통신</strong>을 감지할 수 있도록 설정  </li>
<li><strong>기존 웹 애플리케이션의 보안 점검</strong>을 주기적으로 실시하여 <strong>웹 서비스 취약점</strong>을 사전에 해결</li>
</ul></li>
<li><p><strong>출발지 IP 주소 및 도메인 필터링 (M1030 - Domain Filtering)</strong></p>

<ul>
<li><strong>명령 및 제어 서버</strong>와의 연결을 차단하기 위해 <strong>의심스러운 IP 주소</strong>나 <strong>도메인</strong>을 차단  </li>
<li><strong>출발지 IP 주소</strong> 또는 <strong>도메인 이름</strong>에 대한 <strong>DNS 필터링</strong>을 설정하여 <strong>웹 기반 C2 서버</strong>와의 통신을 차단  </li>
<li><strong>DNS 로그</strong>를 분석하여 <strong>의심스러운 도메인 요청</strong>을 탐지하고 <strong>네트워크를 통한 C2 트래픽</strong>을 차단</li>
</ul></li>
<li><p><strong>SSL/TLS 인프라 모니터링 및 강제 종료 (M1012 - Network Encryption)</strong></p>

<ul>
<li><strong>SSL/TLS 트래픽</strong>을 모니터링하고, <strong>HTTPS</strong>로 암호화된 트래픽도 <strong>인증서 검증 및 무결성 검사</strong>를 수행하여 <strong>비정상적인 암호화된 C2 트래픽</strong>을 탐지  </li>
<li><strong>중간자 공격</strong> 방지를 위해 <strong>SSL/TLS 검증</strong>을 강화하고, <strong>HTTPS 세션 종료</strong> 시 <strong>비정상적인 연결 종료</strong>를 검토  </li>
<li><strong>SSL/TLS 세션 검사</strong>를 강화하여 <strong>네트워크 암호화 트래픽</strong> 내에서 발생하는 악성 명령 및 제어 활동을 식별</li>
</ul></li>
<li><p><strong>네트워크 세분화 및 내부 네트워크 방어 강화 (M1037 - Network Segmentation)</strong></p>

<ul>
<li><strong>내부 네트워크</strong>와 <strong>외부 네트워크</strong>를 <strong>세분화</strong>하여 <strong>내부 시스템</strong>이 <strong>외부와 직접 연결</strong>되지 않도록 방지  </li>
<li><strong>내부 네트워크 방어</strong>를 강화하고, <strong>외부와의 네트워크 통신</strong>을 엄격히 제한하여 <strong>웹 프로토콜</strong>을 통한 <strong>C2 통신 경로</strong>를 차단  </li>
<li><strong>VLAN</strong>을 사용하여 <strong>내부 네트워크</strong>에서 <strong>공용 네트워크</strong>로의 불필요한 트래픽 흐름을 차단</li>
</ul></li>
<li><p><strong>HTTP/HTTPS 요청 필터링 및 패턴 분석 (M1040 - Behavior-Based Detection)</strong></p>

<ul>
<li><strong>HTTP/HTTPS 요청 패턴</strong>을 분석하여 <strong>비정상적인 요청</strong>을 실시간으로 탐지  </li>
<li><strong>행위 기반 탐지 시스템</strong>을 사용하여 <strong>웹 트래픽</strong>의 <strong>비정상적인 동작</strong>을 감지하고, <strong>C2 트래픽</strong>으로 의심되는 활동을 식별  </li>
<li><strong>웹 프로토콜 요청</strong>을 필터링하고, <strong>정상적인 웹 요청</strong>과 <strong>악성 C2 요청</strong>을 구분하는 규칙을 설정</li>
</ul></li>
<li><p><strong>보안 정책 및 웹 사용 규정 설정 (M1019 - Awareness and Training)</strong></p>

<ul>
<li><strong>웹 프로토콜 사용</strong>에 대한 <strong>보안 규정</strong>을 설정하여 <strong>불필요한 웹 통신</strong>을 차단하고 <strong>웹 기반 C2 통신</strong>을 방지  </li>
<li><strong>직원 교육</strong>을 통해 <strong>웹 애플리케이션 및 브라우저 보안</strong>에 대한 인식을 높이고, <strong>웹 프로토콜</strong>을 통한 공격 시나리오에 대한 대응 능력을 향상  </li>
<li><strong>보안 인식 교육</strong>을 통해 웹 기반 공격과 관련된 <strong>C2 활동</strong>에 대해 직원들이 알 수 있도록 돕기</li>
</ul></li>
<li><p><strong>침해 탐지 시스템(IDS/IPS) 사용 (M1047 - System Logging &amp; Monitoring)</strong></p>

<ul>
<li><strong>침해 탐지 시스템(IDS/IPS)</strong>을 활용하여 <strong>HTTP/HTTPS 트래픽</strong>을 모니터링하고, <strong>C2 서버</strong>와의 의심스러운 연결을 감지  </li>
<li><strong>HTTPS 트래픽</strong>에서 발생하는 <strong>비정상적인 행위</strong>를 식별하고, <strong>의심스러운 요청</strong>을 차단하는 설정을 적용  </li>
<li><strong>SSL 인증서</strong> 검사를 활성화하여 <strong>암호화된 트래픽 내</strong>에서의 <strong>비정상적인 C2 요청</strong>을 탐지</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1071.001</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-NTF Network Traffic Filtering</td>
</tr>
<tr>
  <td style="text-align:center;">D3-ITF Inbound Traffic Filtering</td>
</tr>
<tr>
  <td style="text-align:center;">D3-OTF Outbound Traffic Filtering</td>
</tr>
</tbody>
</table>

</body>
</html>
