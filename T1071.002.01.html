<!DOCTYPE html>
<html>
<head>
    <title>T1071.002.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1071.002.01 FTP C2 Implementation</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>FTP를 이용한 C&amp;C 통신을 탐지하기 위해서는 네트워크 트래픽 분석과 이상 행동 모니터링을 해야한다.</p>

<ol>
<li>네트워크 트래픽 분석 : FTP 프로토콜을 사용하는 트래픽을 분석하여 비정상적인 패턴을 탐지할 수 있다. 정상적인 사용 패턴과 비교하여 데이터 전송량이 비정상적으로 높거나, 특정 IP와의 연결이 반복적으로 발생하는지 모니터링한다.</li>
<li>비정상적인 FTP 연결 시도 탐지 : 공격자는 FTP 연결을 사용하여 C&amp;C 서버에 접속할 수 있다. 비정상적으로 많은 연결 시도가 특정 IP에서 발생하는지 확인한다.</li>
<li>파일 전송 패턴 분석 : FTP를 통한 데이터 전송이 정상적인 활동과 다른 패턴을 보이는지 분석한다. 예를 들어, 의심스러운 파일이 전송되거나 비정상적인 크기의 파일이 자주 업로드되는지 확인한다.</li>
</ol>

<h3>Detection(EDR)</h3>

<p><img src="캡처.PNG" alt="" /></p>

<h3>Response</h3>

<ol>
<li>네트워크 차단 : 의심스러운 C&amp;C 서버(IP)를 차단하여 추가적인 통신을 방지한다. 방화벽 설정을 통해 해당 IP와의 모든 연결을 차단한다.</li>
<li>로그 및 증거 수집 : C&amp;C 통신이 이루어진 로그와 관련 데이터를 수집하여 분석한다. FTP 로그, 네트워크 트래픽 로그 및 관련 시스템 로그를 확보하여 분석하고, 향후 사건에 대한 증거로 보관한다.</li>
</ol>

<h3>Mitigations</h3>

<ol>
<li><p><strong>FTP 사용 제한</strong></p>

<ul>
<li>FTP 프로토콜을 사용하는 서비스가 필요하지 않은 경우 비활성화한다.</li>
<li>필요한 경우에도 보안 강화된 SFTP(Secure FTP)를 사용하도록 한다.</li>
</ul></li>
<li><p><strong>네트워크 모니터링 강화</strong></p>

<ul>
<li>네트워크 트래픽을 모니터링하는 시스템을 강화하고, 정상적인 사용 패턴을 정의하여 이를 기반으로 비정상적인 트래픽을 탐지할 수 있도록 한다.</li>
<li>정기적인 로그 분석과 모니터링이 필요하다.</li>
</ul></li>
<li><p><strong>침입 방지 시스템(IPS) 도입</strong></p>

<ul>
<li>IPS를 도입하여 비정상적인 트래픽 패턴을 실시간으로 탐지하고 차단한다.</li>
<li>FTP C&amp;C 통신의 징후를 발견하면 즉시 경고를 생성하고 차단 조치를 취할 수 있다.</li>
</ul></li>
<li><p><strong>사용자 교육 및 인식 강화</strong></p>

<ul>
<li>직원들에게 C&amp;C 서버 및 악성 FTP 통신의 위험성에 대해 교육하고, 의심스러운 활동을 신고하도록 유도한다.</li>
<li>보안 인식을 높이는 것은 잠재적인 공격을 줄이는 데 도움을 줄 수 있다.</li>
</ul></li>
<li><p><strong>정기적인 보안 점검</strong></p>

<ul>
<li>시스템 및 네트워크 환경에 대한 정기적인 보안 점검과 취약점 분석을 통해 C&amp;C 통신을 위한 보안 허점을 사전에 파악하고 조치한다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1071.002</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-NTF Network Traffic Filtering</td>
</tr>
<tr>
  <td style="text-align:center;">D3-NTA Network Traffic Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-ITF Inbound Traffic Filtering</td>
</tr>
</tbody>
</table>

</body>
</html>
