<!DOCTYPE html>
<html>
<head>
    <title>T1003.008.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1003.008.01 /etc/sahdow 파일 복사</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>Action = "ProcessCreate" AND
CurrntProcess != "etc_shadow" AND
Cmdline = "cat /etc/shadow"</p>

<h3>Detection(EDR)</h3>

<p><img src="T1003.008.01.png" alt="T1003 008 01" /></p>

<h3>Response</h3>

<p>침해된 계정의 자격 증명(패스워드)을 즉시 변경하고, 공격자가 탈취한 자격 증명을 사용하여 네트워크 내 다른 시스템에 접근하지 못하도록 조치합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>자격 증명 보호</strong>  </p>

<ul>
<li><strong>LSA 보호</strong>를 활성화하여 SAM 파일을 보호하고 <strong>Credential Guard</strong>를 사용하여 시스템에서 크리덴셜을 안전하게 저장합니다.  </li>
<li>SAM 파일이 저장된 경로(<code data-language="powershell">C:\Windows\System32\config\</code>)의 접근을 제한하여 비관리자 계정이 파일에 접근할 수 없도록 설정합니다.  </li>
</ul></li>
<li><p><strong>보안 솔루션 강화</strong>  </p>

<ul>
<li>EDR/XDR 솔루션을 사용하여 SAM 덤핑 관련 도구인 <code data-language="powershell">Mimikatz</code>, <code data-language="powershell">procdump</code>, <code data-language="powershell">volatility</code> 등의 실행을 탐지합니다.  </li>
<li>Microsoft Defender의 <strong>Attack Surface Reduction</strong> (ASR) 정책을 사용하여 악성 프로세스가 SAM 파일에 접근하는 것을 차단합니다.  </li>
</ul></li>
<li><p><strong>이벤트 로깅 및 감사 정책 강화</strong>  </p>

<ul>
<li><strong>Windows Event Log</strong>에서 <strong>SAM 파일 접근, 로그인 시도 및 비정상적인 권한 상승</strong>을 모니터링합니다.  </li>
<li>중요한 이벤트에 대해 실시간 경고를 설정하고, SIEM에서 SAM 관련 접근 시도(<code data-language="powershell">4663</code>, <code data-language="powershell">4672</code>, <code data-language="powershell">4720</code>, <code data-language="powershell">4732</code>)를 로깅합니다.  </li>
</ul></li>
<li><p><strong>권한 제어</strong>  </p>

<ul>
<li>로컬 관리자 계정 및 시스템 권한을 최소화하고 <strong>최소 권한 원칙</strong>을 적용하여 <strong>AdminSDHolder</strong> 계정에 대한 권한을 제한합니다.  </li>
<li>로컬 관리자가 시스템 파일 및 레지스트리 키에 접근할 수 없도록 <code data-language="powershell">SeBackupPrivilege</code>, <code data-language="powershell">SeRestorePrivilege</code> 권한을 제한합니다.  </li>
</ul></li>
<li><p><strong>레지스트리 및 시스템 설정 보호</strong>  </p>

<ul>
<li><strong>Windows Defender</strong>에서 <strong>Tamper Protection</strong>을 활성화하여 SAM 파일에 대한 변경을 방지합니다.  </li>
<li><code data-language="powershell">SAM</code>, <code data-language="powershell">SYSTEM</code>, <code data-language="powershell">SECURITY</code> 레지스트리 파일의 접근을 제한하고 백업 권한을 최소화합니다.  </li>
</ul></li>
<li><p><strong>네트워크 보안 및 모니터링</strong>  </p>

<ul>
<li>원격 데스크탑 프로토콜(RDP)과 같은 원격 접속을 제한하고, <strong>NLA(Network Level Authentication)</strong> 및 <strong>2단계 인증(MFA)</strong>을 활성화하여 인증된 사용자만 원격으로 시스템에 접근할 수 있도록 합니다.  </li>
<li>네트워크에서 비정상적인 로그인 시도나 시스템 액세스를 감지하는 네트워크 보안 솔루션을 적용합니다.  </li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1003.008</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-FAPA File Access Pattern Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-FCA File Creation Analysis</td>
</tr>
</tbody>
</table>

</body>
</html>
