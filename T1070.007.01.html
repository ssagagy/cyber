<!DOCTYPE html>
<html>
<head>
    <title>T1070.007.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1070.007.01 Clear Network Connection History and Configurations</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>(Action = File-Delete) AND
(Current Process name = "powershell.exe") AND
(Current Process path = "system32" OR "syswow64") AND
(Target Process exetention = "rdp") AND
(Target Process path != "system32" OR "syswow64")</p>

<h3>Detection(EDR)</h3>

<p><img src="T1070_007_01.png" alt="T1070_007_01" /></p>

<h3>Response</h3>

<p>해당 행위를 수행한 프로세스를 종료합니다.
공격자에 의해 PC가 제어되었을 가능성이 있으므로 호스트 네트워크를 격리합니다.
공격자 C&amp;C 서버로 추정되는 주소를 차단합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>로그 감사 강화 (Logging and Monitoring)</strong></p>

<ul>
<li>로그 tampering을 방지하기 위해 네트워크 연결 로그를 주기적으로 감사하고 모니터링하는 것이 중요합니다.</li>
<li>특히, 네트워크 공유 연결과 관련된 로그에 대한 변조 시도를 실시간으로 모니터링할 수 있는 보안 솔루션을 도입해야 합니다.</li>
</ul></li>
<li><p><strong>권한 관리 (Access Control)</strong></p>

<ul>
<li>네트워크 공유 로그에 대한 접근 권한을 최소한으로 제한합니다.</li>
<li>관리자가 아닌 사용자에게 로그 파일 수정 권한을 부여하지 않도록 설정해야 하며, 필요 시 엄격한 권한 관리 정책을 적용해야 합니다.</li>
</ul></li>
<li><p><strong>로그 보존 및 백업 (Log Retention and Backups)</strong></p>

<ul>
<li>중요 로그 파일은 별도의 안전한 위치에 저장하고, 정기적으로 백업해야 합니다.</li>
<li>이를 통해 공격자가 원본 로그를 변조하거나 삭제하더라도 복구할 수 있습니다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1059.001</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-ACI Authentication Cache Invalidation</td>
</tr>
</tbody>
</table>

</body>
</html>
