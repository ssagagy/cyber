<!DOCTYPE html>
<html>
<head>
    <title>T1036.003.01</title>
    <link rel="stylesheet" type="text/css" href="KISA_HTML_CSS.css">
</head>
<body>
<h1>T1036.003.01 시스템 유틸리티 이름 변경</h1>

<h2>D3FEND</h2>

<p>MITRE ATT&amp;CK 액션을 기준으로 대응 방안을 작성</p>

<h3>Detection</h3>

<p>Microsoft 파일을 다른 이름으로 복제하는 행위를 탐지합니다.</p>

<h3>Detection(EDR)</h3>

<p><img src="T1036.003.01.png" alt="T1036.003.01" /></p>

<h3>Response</h3>

<ol>
<li>파일 시스템 분석: </li>
</ol>

<p>시스템에서 비정상적인 파일 이름 변경을 탐지하고, 합법적인 시스템 유틸리티와 동일한 이름을 사용한 파일이 다른 경로에 존재하는지 확인합니다. 비정상적인 경로나 이름을 가진 파일을 조사하고, 해당 파일을 악성 코드로 의심합니다.</p>

<ol start="2">
<li>해시값 및 서명 확인: </li>
</ol>

<p>해당 파일의 해시 값을 확인하여 원본 시스템 유틸리티와 일치하는지, 디지털 서명이 유효한지 검증합니다.</p>

<ol start="3">
<li>프로세스 모니터링: </li>
</ol>

<p>공격자가 시스템 유틸리티를 위장하여 악성 파일을 실행한 경우, Task Manager, Process Explorer, ps 등의 도구를 통해 실행 중인 프로세스를 확인합니다.</p>

<ol start="4">
<li>실행된 파일의 명령 줄 분석: </li>
</ol>

<p>공격자가 위장한 시스템 유틸리티와 관련된 명령 줄을 분석하여, 악성 파일이 어떠한 동작을 수행했는지 파악합니다.</p>

<ol start="5">
<li>비정상적인 네트워크 트래픽 분석: </li>
</ol>

<p>악성 유틸리티가 실행된 후 외부로 데이터가 전송되거나 원격 서버와의 통신이 발생했는지 확인하기 위해 네트워크 트래픽을 분석합니다. Wireshark 또는 NetFlow를 사용하여 비정상적인 네트워크 연결을 탐지합니다.</p>

<ol start="6">
<li>외부 연결 차단: </li>
</ol>

<p>악성 유틸리티가 외부 명령 및 제어(C2) 서버와 통신하려는 경우, 해당 연결을 즉시 차단하고 네트워크 활동을 조사합니다.</p>

<ol start="7">
<li>디스크 및 메모리 포렌식: </li>
</ol>

<p>디스크 이미징을 수행하여 변경된 파일과 관련된 전체 파일 시스템을 분석하고, 악성 파일이 원본 시스템 유틸리티와 어떤 관계가 있는지 파악합니다. 메모리 덤프를 분석하여 공격자가 실행한 프로세스와 그 활동을 추적합니다.</p>

<ol start="8">
<li>시스템 유틸리티가 저장된 경로 확인: </li>
</ol>

<p>시스템 유틸리티가 정상적인 경로에서 실행되고 있는지 확인하고, 경로가 변경되었거나 복제된 경우 해당 파일을 조사합니다.</p>

<ol start="9">
<li>악성 파일 삭제: </li>
</ol>

<p>공격자가 위장하여 사용한 시스템 유틸리티를 악성 파일로 확인한 경우, 이를 즉시 삭제합니다. 삭제하기 전에, 포렌식 증거 수집을 위해 파일을 백업합니다.</p>

<ol start="10">
<li>안티바이러스 및 EDR 사용:</li>
</ol>

<p>안티바이러스(AV) 또는 엔드포인트 탐지 및 대응(EDR) 솔루션을 사용하여 악성 파일을 스캔하고 제거합니다.</p>

<ol start="11">
<li>피해 시스템 격리: </li>
</ol>

<p>공격자의 활동이 확인된 시스템을 네트워크에서 격리하여 추가적인 악성 활동을 방지하고, 시스템 복구 및 포렌식 분석을 위한 준비를 합니다.</p>

<ol start="12">
<li>확산 방지: </li>
</ol>

<p>공격자가 사용한 동일한 기술이 네트워크 내 다른 시스템에도 적용되었을 가능성을 염두에 두고, 다른 시스템도 점검하고 필요한 경우 격리합니다.</p>

<ol start="13">
<li>보안 정책 검토 및 강화: </li>
</ol>

<p>위장 기법을 통한 공격이 발생한 후, 내부 보안 정책을 재평가하고 파일 이름 변경에 대한 보안 절차를 강화합니다.</p>

<ol start="14">
<li>사용자 교육: </li>
</ol>

<p>시스템 유틸리티 위장을 통한 공격을 방지하기 위해, 사용자들에게 의심스러운 파일 실행에 대해 경각심을 갖도록 교육합니다.</p>

<h3>Mitigations</h3>

<ol>
<li><p><strong>애플리케이션 화이트리스트 설정</strong> </p>

<ul>
<li>실행이 허가된 애플리케이션 목록을 설정하여, 시스템 유틸리티가 아닌 파일이나 이름이 변경된 파일이 실행되지 않도록 제한합니다.</li>
</ul></li>
<li><p><strong>소프트웨어 제한 정책(SRP) 및 AppLocker 사용</strong> </p>

<ul>
<li>Windows에서는 SRP(Software Restriction Policy) 또는 AppLocker를 활용하여 승인되지 않은 프로그램이 실행되지 않도록 차단할 수 있습니다.</li>
</ul></li>
<li><p><strong>시스템 유틸리티 무결성 검사</strong> </p>

<ul>
<li>중요한 시스템 유틸리티 파일이 변경되었는지 감시하는 파일 무결성 모니터링 도구를 사용하여 파일의 예상치 못한 변경을 탐지합니다.</li>
</ul></li>
<li><p><strong>해시 값 검증</strong> </p>

<ul>
<li>시스템 유틸리티의 파일 해시를 정기적으로 검증하여, 원본 유틸리티가 악성 파일로 대체되었는지 확인합니다.</li>
</ul></li>
<li><p><strong>관리자 권한 제한</strong></p>

<ul>
<li>중요한 시스템 유틸리티 실행을 관리자 계정에만 허용하고, 일반 사용자 계정에서는 실행하지 못하도록 제한합니다.</li>
</ul></li>
<li><p><strong>경로 기반 실행 제한</strong></p>

<ul>
<li>공격자가 유틸리티를 다른 경로에 복사하여 사용하는 것을 방지하기 위해, 특정 경로 외의 유틸리티 실행을 차단합니다.</li>
</ul></li>
<li><p><strong>실행 로그 기록</strong> </p>

<ul>
<li>시스템 유틸리티와 관련된 파일 이름 변경이나 실행 시도를 모니터링하고, 비정상적인 실행을 탐지하기 위해 시스템 로그를 설정합니다.</li>
</ul></li>
<li><p><strong>SIEM 경고 설정</strong></p>

<ul>
<li>SIEM(Security Information and Event Management) 솔루션을 사용하여 비정상적인 시스템 유틸리티 실행이나 파일 이름 변경 시 경고를 발생시킵니다.</li>
</ul></li>
</ol>

<h2>Affected Techniques</h2>

<p>Action 실행시 함꼐 영향을 받는 다른 Techniqes </p>

<table>
<thead>
<tr>
  <th style="text-align:center;">ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">T1036.003</td>
</tr>
<tr>
  <td style="text-align:center;">T1059.003</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
  <th style="text-align:center;">D3FEND</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">D3-FIM File Integrity Monitoring</td>
</tr>
<tr>
  <td style="text-align:center;">D3-SICA System Init Config Analysis</td>
</tr>
<tr>
  <td style="text-align:center;">D3-FA File Analysis</td>
</tr>
</tbody>
</table>

</body>
</html>
